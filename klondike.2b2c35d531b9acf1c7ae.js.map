{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/ts/redux/globals.ts","webpack:///./src/ts/redux/undoable.ts","webpack:///./src/ts/lib/Stack.ts","webpack:///./src/ts/lib/util.ts","webpack:///./src/ts/redux/selectors.ts","webpack:///./src/ts/lib/Card.ts","webpack:///./src/styles/cards.scss","webpack:///./src/ts/redux/stock.ts","webpack:///./src/ts/redux/score.ts","webpack:///./src/ts/lib/persist.ts","webpack:///./src/ts/redux/deck.ts","webpack:///./src/ts/redux/actions.ts","webpack:///./src/ts/index.tsx","webpack:///./src/ts/store.ts","webpack:///./src/ts/redux/index.ts","webpack:///./src/ts/redux/tableau.ts","webpack:///./src/ts/redux/foundation.ts","webpack:///./src/ts/redux/waste.ts","webpack:///./src/ts/components/Container.tsx","webpack:///./src/ts/components/Stack.tsx","webpack:///./src/ts/components/Fireworks.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","ScoringType","ScoreType","INITIALIZE","SELECT_CARD","DESELECT_CARD","MOVE_CARDS","REVEAL_TOP","APPEND_CARDS","CHANGE_SCORE_TYPE","globals_1","UNDO","undo","type","REDO","redo","CHECKPOINT","checkpoint","undoable","reducer","initialState","past","present","undefined","future","state","action","previous","next","newFuture","newPresent","StackDirection","StackType","Card_1","valueToInt","ValueType","ace","jack","queen","king","parseInt","random","min","max","Math","floor","get_top_card","stack","cards","get_selection","stacks","selection","card","select_card","stackCard","map","some","item","contains","assign","selected","deselect_card","move_cards","from","to","hidden","filter","indexOf","append_cards","movable_to_foundation","card1","card2","suit","movable_to_tableau","isRed","isBlack","reselect_1","getFoundation","createSelector","foundation","getScore","score","getStock","stock","getTableau","tableau","getWaste","waste","getDeck","deck","getAllStacks","WIDTH","HEIGHT","SuitType","Cards","entries","diamond","heart","club","spade","drawing","getDrawing","color","fontSize","pos","three","five","nine","x","y","two","four","six","seven","eight","ten","getTop","getLeft","getTextAlign","cornerFont","valueXOffset","valueYOffset","suitXOffset","suitYOffset","positions","textAlign","rotated","left","top","container","fireworks","play","version","new-game","newGame","switch-score-type","switchScoreType","undoable_1","Stack_1","util_1","DECREMENT_DRAWS","decrementDraws","drawsLeft","Infinity","default","scoringType","vegas","persist_1","INCREMENT_SCORE","incrementScore","scoreType","getSavedScore","regular","oldScore","tableauToFoundation","wasteToFoundation","revealCard","wasteToTableau","foundationToTableau","saveScore","localStorage","setItem","toString","err","getItem","parsed","Number","isNaN","selectors_1","REMOVE_CARD","removeCards","getRandomCards","count","dispatch","getState","deck_cards","index","deck_1","score_1","stock_1","initialize","newScoringType","stock_stack_cards","appendCards","tableau_stack_cards","selectCard","deselectCard","moveCards","from_card","reverse","Error","findIndex","reveal","doubleClick","foundation_stack","find","first","top_card","clickFoundation","selected_card","from_stack","clickWaste","clickTableau","clickStock","waste_stack","stock_stack","React","ReactDOM","offline","react_redux_1","store_1","actions_1","Container_1","install","[object Object]","applyUpdate","location","reload","store","render","createElement","Provider","Container","document","getElementById","redux_1","redux_thunk_1","redux_2","redux_subscribe_reselect_1","middleware","createStore","applyMiddleware","tableau_1","foundation_1","waste_1","combineReducers","showing","Fireworks_1","cards_scss_1","Stack_2","selector","connect","handleNewGame","handleSwitchGameType","newGameType","handleStockClick","handleTableauClick","handleWasteClick","handleFoundationClick","handleDoubleClick","handleUndo","handleRedo","PureComponent","props","super","this","handleNewGameClick","handleKeyDown","handleSwitchGameTypeClick","addEventListener","removeEventListener","otherGameType","e","keyCode","ctrlKey","shiftKey","className","id","onClick","StackComponent","direction","none","onDoubleClick","horizontal","offset","vertical","ref","createRef","handleCanvasClick","handleCanvasDoubleClick","stack_style","canvas_width","width","height","canvas_height","evt","nativeEvent","prop","updateCanvas","canvas","current","ctx","getContext","save","translate","clearRect","drawBoxRadius","stroke","font","fillStyle","textBaseline","fillText","restore","drawClipRegion","drawCard","radius","clip_width","clip_height","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","clip","stack_card","fill","rotate","PI","factor","defaultProps","FireworksCanvas","active","every","handleDocumentKeyDown","ev","stop","start","kill","destroy"],"mappings":"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","file":"klondike.2b2c35d531b9acf1c7ae.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([24,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Stack, StackCard } from '../lib/Stack'\n\nexport enum ScoringType {\n  vegas,\n  regular\n}\n\nexport enum ScoreType {\n  wasteToTableau,\n  wasteToFoundation,\n  tableauToFoundation,\n  revealCard,\n  foundationToTableau\n}\n\nexport const INITIALIZE = 'INITIALIZE'\ntype INITIALIZE = typeof INITIALIZE\nexport type Initialize = { type: INITIALIZE; scoringType: ScoringType }\n\nexport const SELECT_CARD = 'SELECT_CARD'\ntype SELECT_CARD = typeof SELECT_CARD\nexport type SelectAction = { type: SELECT_CARD; stack: Stack; card: StackCard }\n\nexport const DESELECT_CARD = 'DESELECT_CARD'\ntype DESELECT_CARD = typeof DESELECT_CARD\nexport type DeselectAction = { type: DESELECT_CARD }\n\nexport const MOVE_CARDS = 'MOVE_CARDS'\ntype MOVE_CARDS = typeof MOVE_CARDS\nexport type MoveCardAction = {\n  type: MOVE_CARDS\n  from: Stack\n  to: Stack\n  cards: StackCard[]\n  hidden: boolean\n}\n\nexport const REVEAL_TOP = 'REVEAL_TOP'\ntype REVEAL_TOP = typeof REVEAL_TOP\nexport type RevealTopCardAction = { type: REVEAL_TOP; stack: Stack }\n\nexport const APPEND_CARDS = 'APPEND_CARDS'\ntype APPEND_CARDS = typeof APPEND_CARDS\nexport type AppendCardAction = {\n  type: APPEND_CARDS\n  stack: Stack\n  cards: StackCard[]\n}\n\nexport const CHANGE_SCORE_TYPE = 'CHANGE_SCORE_TYPE'\ntype CHANGE_SCORE_TYPE = typeof CHANGE_SCORE_TYPE\nexport type ChangeScoreAction = {\n  type: CHANGE_SCORE_TYPE\n}\n\nexport type GlobalActions =\n  | Initialize\n  | SelectAction\n  | DeselectAction\n  | MoveCardAction\n  | RevealTopCardAction\n  | AppendCardAction\n  | ChangeScoreAction\n","import { Reducer, Action, AnyAction } from 'redux'\nimport { INITIALIZE } from './globals'\n\nexport type History<State> = {\n  past: State[]\n  present: State\n  future: State[]\n}\n\nconst UNDO = 'UNDO'\ntype UNDO = typeof UNDO\ntype UndoAction = { type: UNDO }\nexport const undo = (): UndoAction => ({ type: UNDO })\n\nconst REDO = 'REDO'\ntype REDO = typeof REDO\ntype RedoAction = { type: REDO }\nexport const redo = (): RedoAction => ({ type: REDO })\n\nconst CHECKPOINT = 'CHECKPOINT'\ntype CHECKPOINT = typeof CHECKPOINT\ntype CheckpointAction = { type: CHECKPOINT }\nexport const checkpoint = (): CheckpointAction => ({ type: CHECKPOINT })\n\nexport type UndoableActions = UndoAction | RedoAction | CheckpointAction\n\nexport function undoable<S, A extends AnyAction = Action>(\n  reducer: Reducer<S, A>\n) {\n  const initialState: History<S> = {\n    past: [],\n    present: reducer(undefined, {} as A),\n    future: []\n  }\n\n  return function(state = initialState, action: A) {\n    const { past, present, future } = state\n\n    if (action.type === UNDO) {\n      const previous = past[past.length - 1]\n      if (!previous) {\n        return state\n      }\n\n      const newPast = past.slice(0, past.length - 1)\n      return {\n        past: newPast,\n        present: previous,\n        future: [present, ...future]\n      }\n    }\n\n    if (action.type === REDO) {\n      const next = future[0]\n      if (!next) {\n        return state\n      }\n\n      const newFuture = future.slice(1)\n      return {\n        past: [...past, present],\n        present: next,\n        future: newFuture\n      }\n    }\n\n    const newPresent = reducer(present, action)\n\n    if (action.type === INITIALIZE) {\n      return {\n        past: [],\n        present: newPresent,\n        future: []\n      }\n    }\n\n    if (action.type === CHECKPOINT) {\n      return {\n        past: [...past, present],\n        present: newPresent,\n        future: []\n      }\n    }\n\n    if (present === newPresent) {\n      return state\n    }\n\n    return {\n      past,\n      present: newPresent,\n      future\n    }\n  }\n}\n","import { Card } from './Card'\n\nexport type StackCard = {\n  card: Card\n  hidden?: boolean\n  selected?: boolean\n}\n\nexport enum StackDirection {\n  horizontal = 'horizontal',\n  vertical = 'vertical',\n  none = ''\n}\n\nexport enum StackType {\n  tableau = 'tableau',\n  foundation = 'foundation',\n  stock = 'stock',\n  waste = 'waste'\n}\n\nexport type Stack = {\n  cards: StackCard[]\n  selection?: Card\n  type: StackType\n}\n","import { Card, ValueType } from './Card'\nimport { Stack, StackCard } from './Stack'\n\nexport const random = (min: number, max: number): number => {\n  return Math.floor(Math.random() * max) + min\n}\n\nfunction contains(stack: Stack, card: Card) {\n  return stack.cards.some((item: StackCard) => item.card === card)\n}\n\nexport function get_top_card(stack: Stack): StackCard | null {\n  return stack.cards[stack.cards.length - 1]\n}\n\nexport function get_selection(\n  stacks: Stack[]\n): { card: Card; stack: Stack } | null {\n  for (let i = 0; i < stacks.length; i++) {\n    const stack = stacks[i]\n    if (stack.selection == null) {\n      continue\n    }\n    return { card: stack.selection, stack }\n  }\n  return null\n}\n\nexport function select_card(stacks: Stack[], stackCard: StackCard): Stack[] {\n  const card = stackCard.card\n  if (card == null) {\n    return stacks\n  }\n  return stacks.map(stack => {\n    if (!contains(stack, card)) {\n      return stack\n    }\n\n    return {\n      ...stack,\n      cards: stack.cards.map(stackCard => {\n        if (!stackCard.card) {\n          return stackCard\n        }\n        if (stackCard.card !== card) {\n          return stackCard\n        }\n        return { ...stackCard, selected: true }\n      }),\n      selection: card\n    }\n  })\n}\n\nexport function deselect_card(stacks: Stack[]): Stack[] {\n  return stacks.map(stack => {\n    if (!stack.selection) {\n      return stack\n    }\n    return {\n      ...stack,\n      selection: void 0,\n      cards: stack.cards.map(card =>\n        !card.selected ? card : { ...card, selected: void 0 }\n      )\n    }\n  })\n}\n\nexport function move_cards(\n  stacks: Stack[],\n  from: Stack,\n  to: Stack,\n  cards: StackCard[],\n  hidden: boolean\n): Stack[] {\n  return stacks.map(stack => {\n    if (stack === to) {\n      return {\n        ...stack,\n        cards: [\n          ...stack.cards,\n          ...cards.map(card => ({ ...card, selected: false, hidden }))\n        ]\n      }\n    }\n    if (stack === from) {\n      return {\n        ...stack,\n        cards: stack.cards.filter(stackCard => cards.indexOf(stackCard) === -1)\n      }\n    }\n    return stack\n  })\n}\n\nexport function append_cards(stacks: Stack[], to: Stack, cards: StackCard[]) {\n  return stacks.map(stack => {\n    if (stack !== to) {\n      return stack\n    }\n    return {\n      ...stack,\n      cards: [...stack.cards, ...cards]\n    }\n  })\n}\n\nexport function movable_to_foundation(card1: Card, card2?: StackCard | null) {\n  if (card2 == null) {\n    return card1.value === ValueType.ace\n  }\n\n  const { card } = card2\n  if (!card) {\n    return false\n  }\n\n  return (\n    valueToInt(card1.value) === valueToInt(card.value) + 1 &&\n    card1.suit === card.suit\n  )\n}\n\nexport function movable_to_tableau(card1: Card, card2?: StackCard | null) {\n  if (card2 == null) {\n    return card1.value === ValueType.king\n  }\n\n  const { card } = card2\n  if (!card) {\n    return false\n  }\n\n  return (\n    (valueToInt(card1.value) + 1 === valueToInt(card.value) &&\n      card1.isRed &&\n      card.isBlack) ||\n    (card1.isBlack && card.isRed)\n  )\n}\n\nfunction valueToInt(value: ValueType): number {\n  if (value === ValueType.ace) {\n    return 1\n  }\n  if (value === ValueType.jack) {\n    return 11\n  }\n  if (value === ValueType.queen) {\n    return 12\n  }\n  if (value === ValueType.king) {\n    return 13\n  }\n  return parseInt(value)\n}\n","import { createSelector } from 'reselect'\nimport { StoreState } from './index'\n\nexport const getFoundation = createSelector(\n  (state: StoreState) => state.foundation.present,\n  foundation => foundation\n)\n\nexport const getScore = createSelector(\n  (state: StoreState) => state.score.present,\n  score => score\n)\n\nexport const getStock = createSelector(\n  (state: StoreState) => state.stock.present,\n  stock => stock\n)\n\nexport const getTableau = createSelector(\n  (state: StoreState) => state.tableau.present,\n  tableau => tableau\n)\n\nexport const getWaste = createSelector(\n  (state: StoreState) => state.waste.present,\n  waste => waste\n)\n\nexport const getDeck = createSelector(\n  (state: StoreState) => state.deck.present,\n  deck => deck\n)\n\nexport const getAllStacks = createSelector(\n  [getFoundation, getWaste, getTableau],\n  ({ stacks: foundation }, { stacks: waste }, { stacks: tableau }) => [\n    ...foundation,\n    ...waste,\n    ...tableau\n  ]\n)\n","const WIDTH = 75\nconst HEIGHT = 97\n\nexport enum ValueType {\n  ace = 'A',\n  two = '2',\n  three = '3',\n  four = '4',\n  five = '5',\n  six = '6',\n  seven = '7',\n  eight = '8',\n  nine = '9',\n  ten = '10',\n  jack = 'J',\n  queen = 'Q',\n  king = 'K'\n}\n\nenum SuitType {\n  heart = '\\u2665',\n  diamond = '\\u2666',\n  spade = '\\u2660',\n  club = '\\u2663'\n}\n\ntype Position = {\n  left: number\n  top: number\n  rotated: boolean\n  textAlign: CanvasTextAlign\n}\n\ntype Drawing = {\n  color: string\n  cornerFont: string\n  fontSize: string\n  suitXOffset: number\n  suitYOffset: number\n  valueXOffset: number\n  valueYOffset: number\n  positions: Position[]\n}\n\nexport type Card = {\n  suit: SuitType\n  value: ValueType\n  drawing: Drawing\n  isRed: boolean\n  isBlack: boolean\n}\n\nexport const Cards: Card[] = []\nfor (const [, value] of Object.entries(ValueType)) {\n  for (const [, suit] of Object.entries(SuitType)) {\n    Cards.push({\n      suit,\n      value,\n      isRed: [SuitType.diamond, SuitType.heart].indexOf(suit) > -1,\n      isBlack: [SuitType.club, SuitType.spade].indexOf(suit) > -1,\n      drawing: getDrawing(suit, value)\n    })\n  }\n}\n\nfunction getDrawing(suit: SuitType, value: ValueType): Drawing {\n  type ypos = 0 | 1 | 2 | 3 | 4 | 5 | 6\n  type xpos = 0 | 1 | 2\n\n  const color =\n    [SuitType.diamond, SuitType.heart].indexOf(suit) > -1 ? 'red' : 'black'\n\n  const fontSize =\n    [ValueType.ace, ValueType.jack, ValueType.queen, ValueType.king].indexOf(\n      value\n    ) > -1\n      ? '72px'\n      : '20px'\n\n  const pos: { x: xpos; y: ypos }[] = []\n\n  if (\n    [\n      ValueType.ace,\n      ValueType.three,\n      ValueType.five,\n      ValueType.nine,\n      ValueType.jack,\n      ValueType.queen,\n      ValueType.king\n    ].indexOf(value) > -1\n  ) {\n    pos.push({ x: 1, y: 3 })\n  }\n\n  if ([ValueType.two, ValueType.three].indexOf(value) > -1) {\n    pos.push({ x: 1, y: 0 }, { x: 1, y: 6 })\n  }\n\n  if (\n    [\n      ValueType.four,\n      ValueType.five,\n      ValueType.six,\n      ValueType.seven,\n      ValueType.eight,\n      ValueType.nine,\n      ValueType.ten\n    ].indexOf(value) > -1\n  ) {\n    pos.push({ x: 0, y: 0 }, { x: 2, y: 0 }, { x: 0, y: 6 }, { x: 2, y: 6 })\n  }\n\n  if ([ValueType.six, ValueType.seven, ValueType.eight].indexOf(value) > -1) {\n    pos.push({ x: 0, y: 3 }, { x: 2, y: 3 })\n  }\n\n  if ([ValueType.seven, ValueType.ten, ValueType.eight].indexOf(value) > -1) {\n    pos.push({ x: 1, y: 1 })\n  }\n\n  if ([ValueType.nine, ValueType.ten].indexOf(value) > -1) {\n    pos.push({ x: 0, y: 2 }, { x: 2, y: 2 }, { x: 0, y: 4 }, { x: 2, y: 4 })\n  }\n\n  if ([ValueType.ten, ValueType.eight].indexOf(value) > -1) {\n    pos.push({ x: 1, y: 5 })\n  }\n\n  const getTop = (y: ypos) => {\n    switch (y) {\n      case 0:\n      case 6:\n        return HEIGHT * 0.2\n      case 1:\n      case 5:\n        return HEIGHT * 0.3\n      case 2:\n      case 4:\n        return HEIGHT * 0.4\n      case 3:\n        return HEIGHT * 0.5\n    }\n  }\n\n  const getLeft = (x: xpos) => {\n    switch (x) {\n      case 0:\n        return WIDTH * 0.25\n      case 1:\n        return WIDTH * 0.5\n      case 2:\n        return WIDTH * 0.75\n    }\n  }\n\n  const getTextAlign = (x: xpos): CanvasTextAlign => {\n    switch (x) {\n      case 0:\n        return 'left'\n      case 1:\n        return 'center'\n      case 2:\n        return 'right'\n    }\n  }\n\n  const positions: Position[] = pos.map(({ x, y }) => {\n    return {\n      textAlign: getTextAlign(x),\n      rotated: y > 3,\n      left: getLeft(x),\n      top: getTop(y)\n    }\n  })\n\n  return {\n    cornerFont: 'bold 15px sans-serif',\n    valueXOffset: 9,\n    valueYOffset: 2,\n    suitXOffset: 9,\n    suitYOffset: 12,\n    color,\n    fontSize,\n    positions\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"_3hBob\",\"fireworks\":\"XihLW\",\"top\":\"_3awzY\",\"play\":\"_1E68Q\",\"stock\":\"_2EnhJ\",\"waste\":\"_3xl1i\",\"foundation\":\"cOfJ3\",\"tableau\":\"_2j3jz\",\"version\":\"_3qfCP\",\"new-game\":\"_3o9uZ\",\"newGame\":\"_3o9uZ\",\"switch-score-type\":\"_2xcpg\",\"switchScoreType\":\"_2xcpg\",\"score\":\"_1xo1P\"};","import { undoable } from './undoable'\nimport { Stack, StackType } from '../lib/Stack'\nimport { append_cards, move_cards } from '../lib/util'\nimport {\n  GlobalActions,\n  INITIALIZE,\n  MOVE_CARDS,\n  APPEND_CARDS,\n  ScoringType\n} from './globals'\n\nconst DECREMENT_DRAWS = 'DECREMENT_DRAWS'\ntype DECREMENT_DRAWS = typeof DECREMENT_DRAWS\ntype DecrementDrawsAction = { type: DECREMENT_DRAWS }\nexport const decrementDraws = (): DecrementDrawsAction => ({\n  type: DECREMENT_DRAWS\n})\n\nexport type StockStore = {\n  readonly drawsLeft: number\n  readonly stacks: Stack[]\n}\n\nexport type StockActions = DecrementDrawsAction\n\nconst initialState: StockStore = {\n  drawsLeft: Infinity,\n  stacks: [\n    {\n      type: StackType.stock,\n      cards: []\n    }\n  ]\n}\n\nfunction stockReducer(\n  state: StockStore = initialState,\n  action: GlobalActions | StockActions\n): StockStore {\n  if (action.type === INITIALIZE) {\n    return {\n      ...initialState,\n      drawsLeft: action.scoringType === ScoringType.vegas ? 2 : Infinity\n    }\n  }\n\n  if (action.type === DECREMENT_DRAWS) {\n    return {\n      ...state,\n      drawsLeft: state.drawsLeft - 1\n    }\n  }\n\n  if (\n    action.type === MOVE_CARDS &&\n    state.stacks.some(stack => [action.from, action.to].indexOf(stack) > -1)\n  ) {\n    return {\n      ...state,\n      stacks: move_cards(\n        state.stacks,\n        action.from,\n        action.to,\n        action.cards,\n        action.hidden\n      )\n    }\n  }\n\n  if (\n    action.type === APPEND_CARDS &&\n    state.stacks.some(stack => action.stack === stack)\n  ) {\n    return {\n      ...state,\n      stacks: append_cards(state.stacks, action.stack, action.cards)\n    }\n  }\n\n  return state\n}\n\nexport default undoable(stockReducer)\n","import { INITIALIZE, GlobalActions, ScoreType, ScoringType } from './globals'\nimport { undoable } from './undoable'\nimport { getSavedScore } from '../lib/persist'\n\nconst INCREMENT_SCORE = 'INCREMENT_SCORE'\ntype INCREMENT_SCORE = typeof INCREMENT_SCORE\n\ntype IncrementAction = {\n  type: INCREMENT_SCORE\n  scoreType: ScoreType\n}\n\nexport function incrementScore(scoreType: ScoreType): IncrementAction {\n  return { type: INCREMENT_SCORE, scoreType }\n}\n\nexport type ScoreStore = {\n  readonly score: number\n  readonly scoringType: ScoringType\n}\n\nexport type ScoreActions = IncrementAction\n\nconst score = getSavedScore()\nconst initialState: ScoreStore = { score, scoringType: ScoringType.regular }\n\nfunction scoreReducer(\n  state: ScoreStore = initialState,\n  action: ScoreActions | GlobalActions\n): ScoreStore {\n  if (action.type === INITIALIZE) {\n    const oldScore = getSavedScore()\n\n    return {\n      score: action.scoringType === ScoringType.vegas ? oldScore - 52 : 0,\n      scoringType: action.scoringType\n    }\n  }\n\n  if (action.type === INCREMENT_SCORE) {\n    let score = 0\n    if (\n      state.scoringType === ScoringType.regular &&\n      action.scoreType === ScoreType.tableauToFoundation\n    ) {\n      score = 10\n    } else if (\n      action.scoreType === ScoreType.wasteToFoundation ||\n      (state.scoringType === ScoringType.vegas &&\n        action.scoreType === ScoreType.tableauToFoundation) ||\n      (state.scoringType === ScoringType.regular &&\n        action.scoreType === ScoreType.revealCard) ||\n      (state.scoringType === ScoringType.regular &&\n        action.scoreType === ScoreType.wasteToTableau)\n    ) {\n      score = 5\n    } else if (\n      state.scoringType === ScoringType.regular &&\n      ScoreType.foundationToTableau\n    ) {\n      score = 10\n    } else if (\n      state.scoringType === ScoringType.vegas &&\n      action.scoreType === ScoreType.foundationToTableau\n    ) {\n      score = -5\n    }\n\n    return { ...state, score: state.score + score }\n  }\n\n  return state\n}\n\nexport default undoable(scoreReducer)\n","import { ScoreStore } from '../redux/score'\nimport { ScoringType } from '../redux/globals'\n\nexport function saveScore(score: ScoreStore): void {\n  try {\n    if (score.scoringType === ScoringType.vegas) {\n      localStorage.setItem('score', score.score.toString())\n    }\n  } catch (err) {\n    // ehh, that sucks\n  }\n}\n\nexport function getSavedScore(): number {\n  try {\n    let score = localStorage.getItem('score')\n    if (score == null) {\n      return 0\n    }\n\n    let parsed = parseInt(score, 10)\n    if (Number.isNaN(parsed)) {\n      return 0\n    }\n\n    return parsed\n  } catch (err) {\n    return 0\n  }\n}\n","import { Cards } from '../lib/Card'\nimport { GlobalActions, INITIALIZE } from './globals'\nimport { undoable } from './undoable'\nimport { random } from '../lib/util'\nimport { ThunkResult } from '.'\nimport { getDeck } from './selectors'\nimport { StackCard } from '../lib/Stack'\n\nexport type DeckStore = {\n  readonly cards: StackCard[]\n}\n\nconst REMOVE_CARD = 'REMOVE_CARD'\ntype REMOVE_CARD = typeof REMOVE_CARD\ntype RemoveCardAction = { type: REMOVE_CARD; cards: StackCard[] }\nexport const removeCards = (cards: StackCard[]): RemoveCardAction => ({\n  type: REMOVE_CARD,\n  cards\n})\n\nexport type DeckActions = RemoveCardAction\n\nexport const getRandomCards = (count: Number): ThunkResult<StackCard[]> => {\n  return (dispatch, getState) => {\n    const current_deck = getDeck(getState())\n    const deck_cards = [...current_deck.cards]\n    const cards = []\n    for (let i = 0; i < count; i++) {\n      const index = random(0, deck_cards.length - 1)\n      cards.push(...deck_cards.splice(index, 1))\n    }\n\n    dispatch(removeCards(cards))\n    return cards\n  }\n}\n\nconst initialState: DeckStore = {\n  cards: []\n}\n\nfunction deckReducer(\n  state: DeckStore = initialState,\n  action: DeckActions | GlobalActions\n): DeckStore {\n  if (action.type === INITIALIZE) {\n    const cards = []\n    for (const card of Cards) {\n      cards.push({ card: { ...card } })\n    }\n    return { cards }\n  }\n\n  if (action.type === REMOVE_CARD) {\n    return {\n      cards: state.cards.filter(card => action.cards.indexOf(card) === -1)\n    }\n  }\n\n  return state\n}\n\nexport default undoable(deckReducer)\n","import { ThunkResult } from './index'\nimport {\n  getStock,\n  getTableau,\n  getFoundation,\n  getWaste,\n  getAllStacks\n} from './selectors'\nimport { getRandomCards } from './deck'\nimport { Stack, StackCard, StackType } from '../lib/Stack'\nimport { Card, ValueType } from '../lib/Card'\nimport {\n  get_top_card,\n  movable_to_foundation,\n  get_selection,\n  movable_to_tableau\n} from '../lib/util'\nimport { checkpoint } from './undoable'\nimport { incrementScore } from './score'\nimport {\n  APPEND_CARDS,\n  DESELECT_CARD,\n  INITIALIZE,\n  MOVE_CARDS,\n  REVEAL_TOP,\n  SELECT_CARD,\n  AppendCardAction,\n  DeselectAction,\n  MoveCardAction,\n  RevealTopCardAction,\n  SelectAction,\n  ScoringType,\n  ScoreType\n} from './globals'\nimport { decrementDraws } from './stock'\n\nexport function initialize(newScoringType?: ScoringType): ThunkResult<void> {\n  return (dispatch, getState) => {\n    let scoringType = newScoringType\n    if (scoringType == null) {\n      scoringType = getState().score.present.scoringType\n    }\n\n    dispatch({ type: INITIALIZE, scoringType })\n\n    const stock = getStock(getState())\n\n    const stock_cards = dispatch(getRandomCards(24))\n\n    const stock_stack_cards = stock_cards.map(card => ({\n      ...card,\n      hidden: true\n    }))\n\n    dispatch(appendCards(stock.stacks[0], stock_stack_cards))\n\n    const tableau = getTableau(getState())\n\n    for (let i = 0; i < tableau.stacks.length; i++) {\n      const tableau_cards = dispatch(getRandomCards(i + 1))\n\n      const tableau_stack_cards = tableau_cards.map((card, index) => ({\n        ...card,\n        hidden: index !== i\n      }))\n\n      dispatch(appendCards(tableau.stacks[i], tableau_stack_cards))\n    }\n  }\n}\n\nexport const selectCard = (stack: Stack, card: StackCard): SelectAction => ({\n  type: SELECT_CARD,\n  card,\n  stack\n})\n\nexport const deselectCard = (): DeselectAction => ({ type: DESELECT_CARD })\n\nexport const appendCards = (\n  stack: Stack,\n  cards: StackCard[]\n): AppendCardAction => ({ type: APPEND_CARDS, cards, stack })\n\nexport const moveCards = (\n  from: Stack,\n  to: Stack,\n  from_card: Card | null = null,\n  index: number | null = null,\n  reverse: Boolean = false,\n  hidden: boolean = false\n): MoveCardAction => {\n  if (index == null) {\n    if (from_card == null) {\n      throw new Error('from card reqired when index not provided')\n    }\n    index = from.cards.findIndex(card => !!card.card && card.card === from_card)\n  }\n\n  let cards = from.cards.slice(index)\n  if (reverse) {\n    cards.reverse()\n  }\n\n  return { type: MOVE_CARDS, from, to, cards, hidden }\n}\n\nconst reveal = (stack: Stack): RevealTopCardAction => ({\n  type: REVEAL_TOP,\n  stack\n})\n\nexport function doubleClick(\n  stack: Stack,\n  stackCard?: StackCard\n): ThunkResult<void> {\n  return (dispatch, getState) => {\n    if (stack.type === StackType.foundation || stack.type === StackType.stock) {\n      return\n    }\n\n    if (stackCard == null) {\n      return\n    }\n\n    const { card } = stackCard\n\n    if (card == null) {\n      return\n    }\n\n    const foundation = getFoundation(getState())\n\n    const foundation_stack =\n      card.value === ValueType.ace\n        ? foundation.stacks.find(stack => stack.cards.length === 0)\n        : foundation.stacks.find(stack => {\n            if (stack.cards.length === 0) {\n              return false\n            }\n            const first = stack.cards[0].card\n            if (first == null) {\n              return false\n            }\n            return first.suit === card.suit\n          })\n\n    if (!foundation_stack) {\n      return\n    }\n    const top_card = get_top_card(foundation_stack)\n\n    if (movable_to_foundation(card, top_card)) {\n      dispatch(checkpoint())\n\n      if (stack.type === StackType.waste) {\n        dispatch(incrementScore(ScoreType.wasteToFoundation))\n      }\n\n      if (stack.type === StackType.tableau) {\n        dispatch(incrementScore(ScoreType.tableauToFoundation))\n      }\n\n      dispatch(moveCards(stack, foundation_stack, card))\n      dispatch(deselectCard())\n    }\n  }\n}\n\nexport function clickFoundation(\n  stack: Stack,\n  card?: StackCard\n): ThunkResult<void> {\n  return (dispatch, getState) => {\n    const stacks = getAllStacks(getState())\n    const selection = get_selection(stacks)\n\n    if (!selection) {\n      if (card && card.card) {\n        dispatch(selectCard(stack, card))\n      }\n      return\n    }\n\n    if (card && card.selected) {\n      dispatch(deselectCard())\n      return\n    }\n\n    const top_card = get_top_card(stack)\n    const { card: selected_card, stack: from_stack } = selection\n\n    if (movable_to_foundation(selected_card, top_card)) {\n      dispatch(checkpoint())\n\n      if (from_stack.type === StackType.waste) {\n        dispatch(incrementScore(ScoreType.wasteToFoundation))\n      }\n\n      if (from_stack.type === StackType.tableau) {\n        dispatch(incrementScore(ScoreType.tableauToFoundation))\n      }\n\n      dispatch(moveCards(from_stack, stack, selected_card))\n      dispatch(deselectCard())\n    }\n  }\n}\n\nexport function clickWaste(stack: Stack, card?: StackCard): ThunkResult<void> {\n  return (dispatch, getState) => {\n    if (!card) {\n      return\n    }\n\n    const stacks = getAllStacks(getState())\n    const selection = get_selection(stacks)\n    const top_card = get_top_card(stack)\n\n    if (card.selected) {\n      dispatch(deselectCard())\n      return\n    }\n\n    if (!selection && top_card === card) {\n      dispatch(selectCard(stack, card))\n    }\n  }\n}\n\nexport function clickTableau(\n  stack: Stack,\n  card?: StackCard\n): ThunkResult<void> {\n  return (dispatch, getState) => {\n    const stacks = getAllStacks(getState())\n    const selection = get_selection(stacks)\n    const top_card = get_top_card(stack)\n\n    if (!selection) {\n      if (card && !card.hidden) {\n        dispatch(selectCard(stack, card))\n      } else if (card && top_card && top_card.hidden === true) {\n        dispatch(checkpoint())\n        dispatch(incrementScore(ScoreType.revealCard))\n        dispatch(reveal(stack))\n      }\n      return\n    }\n\n    if (card && card.selected) {\n      dispatch(deselectCard())\n      return\n    }\n\n    const { card: selected_card, stack: from_stack } = selection\n\n    if (card === top_card && movable_to_tableau(selected_card, top_card)) {\n      dispatch(checkpoint())\n\n      if (from_stack.type === StackType.waste) {\n        dispatch(incrementScore(ScoreType.wasteToTableau))\n      }\n\n      if (from_stack.type === StackType.foundation) {\n        dispatch(incrementScore(ScoreType.foundationToTableau))\n      }\n\n      dispatch(moveCards(from_stack, stack, selected_card))\n      dispatch(deselectCard())\n    }\n  }\n}\n\nexport function clickStock(): ThunkResult<void> {\n  return (dispatch, getState) => {\n    const state = getState()\n    const {\n      stacks: [waste_stack]\n    } = getWaste(state)\n    const {\n      stacks: [stock_stack],\n      drawsLeft\n    } = getStock(state)\n\n    if (stock_stack.cards.length === 0 && drawsLeft === 0) {\n      return\n    }\n\n    dispatch(checkpoint())\n    dispatch(deselectCard())\n\n    if (stock_stack.cards.length > 0) {\n      dispatch(moveCards(stock_stack, waste_stack, null, -3, true, false))\n    } else {\n      dispatch(moveCards(waste_stack, stock_stack, null, 0, true, true))\n      dispatch(decrementDraws())\n    }\n  }\n}\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport * as offline from 'offline-plugin/runtime'\nimport { Provider } from 'react-redux'\nimport configStore from './store'\nimport { initialize } from './redux/actions'\nimport { Container } from './components/Container'\nimport { ThunkDispatch } from './redux'\n\noffline.install({\n  onUpdateReady() {\n    offline.applyUpdate()\n  },\n  onUpdated() {\n    window.location.reload()\n  }\n})\n\nconst store = configStore()\n;(store.dispatch as ThunkDispatch)(initialize())\n\nReactDOM.render(\n  <Provider store={store}>\n    <Container />\n  </Provider>,\n  document.getElementById('root')\n)\n","import { createStore, applyMiddleware } from 'redux'\nimport thunk, { ThunkMiddleware } from 'redux-thunk'\nimport { createLogger } from 'redux-logger'\nimport reducer, { StoreState, StoreActions } from './redux'\nimport subscribe from 'redux-subscribe-reselect'\nimport { ScoreStore } from './redux/score'\nimport { getScore } from './redux/selectors'\nimport { saveScore } from './lib/persist'\n\nexport default function configStore(state?: object) {\n  const middleware = []\n\n  middleware.push(thunk as ThunkMiddleware<StoreState, StoreActions>)\n\n  if (process.env.NODE_ENV !== 'production') {\n    middleware.push(createLogger())\n  }\n\n  const store = createStore(reducer, state!, applyMiddleware(...middleware))\n  subscribe(store, getScore, (score: ScoreStore) => saveScore(score))\n  return store\n}\n","import { combineReducers } from 'redux'\nimport { ThunkAction, ThunkDispatch } from 'redux-thunk'\nimport { GlobalActions } from './globals'\nimport tableau, { TableauStore } from './tableau'\nimport foundation, { FoundationStore } from './foundation'\nimport waste, { WasteStore } from './waste'\nimport stock, { StockStore, StockActions } from './stock'\nimport score, { ScoreStore, ScoreActions } from './score'\nimport deck, { DeckStore, DeckActions } from './deck'\nimport { History, UndoableActions } from './undoable'\n\nexport type StoreActions =\n  | GlobalActions\n  | ScoreActions\n  | UndoableActions\n  | DeckActions\n  | StockActions\n\nexport type StoreState = {\n  deck: History<DeckStore>\n  tableau: History<TableauStore>\n  foundation: History<FoundationStore>\n  waste: History<WasteStore>\n  stock: History<StockStore>\n  score: History<ScoreStore>\n}\n\nexport type ThunkResult<R> = ThunkAction<R, StoreState, null, StoreActions>\nexport type ThunkDispatch = ThunkDispatch<StoreState, null, StoreActions>\n\nexport default combineReducers<StoreState, StoreActions>({\n  deck,\n  tableau,\n  foundation,\n  waste,\n  stock,\n  score\n})\n","import { Stack, StackType } from '../lib/Stack'\nimport {\n  select_card,\n  deselect_card,\n  move_cards,\n  append_cards\n} from '../lib/util'\nimport { undoable } from './undoable'\nimport {\n  GlobalActions,\n  INITIALIZE,\n  SELECT_CARD,\n  DESELECT_CARD,\n  MOVE_CARDS,\n  APPEND_CARDS,\n  REVEAL_TOP\n} from './globals'\n\nexport type TableauStore = {\n  readonly stacks: Stack[]\n}\n\nconst initialState: TableauStore = {\n  stacks: [\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] },\n    { type: StackType.tableau, cards: [] }\n  ]\n}\n\nfunction tableauReducer(\n  state: TableauStore = initialState,\n  action: GlobalActions\n): TableauStore {\n  if (action.type === INITIALIZE) {\n    return { ...initialState }\n  }\n\n  if (\n    action.type === SELECT_CARD &&\n    state.stacks.some(stack => stack === action.stack)\n  ) {\n    return { ...state, stacks: select_card(state.stacks, action.card) }\n  }\n\n  if (\n    action.type === DESELECT_CARD &&\n    state.stacks.some(stack => !!stack.selection)\n  ) {\n    return { ...state, stacks: deselect_card(state.stacks) }\n  }\n\n  if (\n    action.type === MOVE_CARDS &&\n    state.stacks.some(stack => [action.from, action.to].indexOf(stack) > -1)\n  ) {\n    return {\n      ...state,\n      stacks: move_cards(\n        state.stacks,\n        action.from,\n        action.to,\n        action.cards,\n        action.hidden\n      )\n    }\n  }\n\n  if (\n    action.type === APPEND_CARDS &&\n    state.stacks.some(stack => action.stack === stack)\n  ) {\n    return {\n      ...state,\n      stacks: append_cards(state.stacks, action.stack, action.cards)\n    }\n  }\n\n  if (action.type === REVEAL_TOP) {\n    return {\n      ...state,\n      stacks: state.stacks.map(stack => {\n        if (stack !== action.stack) {\n          return stack\n        }\n        return {\n          ...stack,\n          cards: stack.cards.map((card, index) => {\n            if (index < stack.cards.length - 1) {\n              return card\n            }\n            return { ...card, hidden: false }\n          })\n        }\n      })\n    }\n  }\n\n  return state\n}\n\nexport default undoable(tableauReducer)\n","import {\n  INITIALIZE,\n  GlobalActions,\n  SELECT_CARD,\n  DESELECT_CARD,\n  MOVE_CARDS\n} from './globals'\nimport { Stack, StackType } from '../lib/Stack'\nimport { select_card, deselect_card, move_cards } from '../lib/util'\nimport { undoable } from './undoable'\n\nexport type FoundationStore = {\n  readonly stacks: Stack[]\n}\n\nconst initialState: FoundationStore = {\n  stacks: [\n    { type: StackType.foundation, cards: [] },\n    { type: StackType.foundation, cards: [] },\n    { type: StackType.foundation, cards: [] },\n    { type: StackType.foundation, cards: [] }\n  ]\n}\n\nfunction foundationReducer(\n  state: FoundationStore = initialState,\n  action: GlobalActions\n): FoundationStore {\n  if (action.type === INITIALIZE) {\n    return { ...initialState }\n  }\n\n  if (\n    action.type === SELECT_CARD &&\n    state.stacks.some(stack => stack === action.stack)\n  ) {\n    return { ...state, stacks: select_card(state.stacks, action.card) }\n  }\n\n  if (\n    action.type === DESELECT_CARD &&\n    state.stacks.some(stack => !!stack.selection)\n  ) {\n    return { ...state, stacks: deselect_card(state.stacks) }\n  }\n\n  if (\n    action.type === MOVE_CARDS &&\n    state.stacks.some(stack => [action.from, action.to].indexOf(stack) > -1)\n  ) {\n    return {\n      ...state,\n      stacks: move_cards(\n        state.stacks,\n        action.from,\n        action.to,\n        action.cards,\n        action.hidden\n      )\n    }\n  }\n\n  return state\n}\n\nexport default undoable(foundationReducer)\n","import {\n  select_card,\n  deselect_card,\n  move_cards,\n  append_cards\n} from '../lib/util'\nimport { Stack, StackType } from '../lib/Stack'\nimport { undoable } from './undoable'\nimport {\n  GlobalActions,\n  INITIALIZE,\n  SELECT_CARD,\n  DESELECT_CARD,\n  MOVE_CARDS,\n  APPEND_CARDS\n} from './globals'\n\nexport type WasteStore = {\n  readonly stacks: Stack[] // this is an array for consistency with other stores\n  readonly showing: number\n}\n\nconst initialState: WasteStore = {\n  stacks: [{ type: StackType.waste, cards: [] }],\n  showing: 0\n}\n\nfunction wasteReducer(\n  state: WasteStore = initialState,\n  action: GlobalActions\n): WasteStore {\n  if (action.type === INITIALIZE) {\n    return { ...initialState }\n  }\n\n  if (\n    action.type === SELECT_CARD &&\n    state.stacks.some(stack => stack === action.stack)\n  ) {\n    return { ...state, stacks: select_card(state.stacks, action.card) }\n  }\n\n  if (\n    action.type === DESELECT_CARD &&\n    state.stacks.some(stack => !!stack.selection)\n  ) {\n    return { ...state, stacks: deselect_card(state.stacks) }\n  }\n\n  if (\n    action.type === MOVE_CARDS &&\n    state.stacks.some(stack => [action.from, action.to].indexOf(stack) > -1)\n  ) {\n    return {\n      ...state,\n      showing:\n        action.to === state.stacks[0]\n          ? Math.min(state.stacks[0].cards.length + action.cards.length, 3)\n          : Math.max(1, state.showing - 1),\n      stacks: move_cards(\n        state.stacks,\n        action.from,\n        action.to,\n        action.cards,\n        action.hidden\n      )\n    }\n  }\n\n  if (\n    action.type === APPEND_CARDS &&\n    state.stacks.some(stack => action.stack === stack)\n  ) {\n    return {\n      ...state,\n      showing:\n        action.stack === state.stacks[0]\n          ? Math.min(state.stacks[0].cards.length + action.cards.length, 3)\n          : Math.max(1, state.showing - 1),\n      stacks: append_cards(state.stacks, action.stack, action.cards)\n    }\n  }\n\n  return state\n}\n\nexport default undoable(wasteReducer)\n","import * as React from 'react'\nimport { connect } from 'react-redux'\nimport { createSelector } from 'reselect'\nimport { StackComponent } from './Stack'\nimport FireworksComponent from './Fireworks'\nimport {\n  container,\n  top,\n  play,\n  newGame,\n  score,\n  version,\n  switchScoreType\n} from '../../styles/cards.scss'\nimport { StoreState, ThunkDispatch } from '../redux'\nimport { Stack, StackCard, StackType, StackDirection } from '../lib/Stack'\nimport {\n  initialize,\n  clickStock,\n  clickTableau,\n  clickWaste,\n  clickFoundation,\n  doubleClick\n} from '../redux/actions'\nimport { WasteStore } from '../redux/waste'\nimport {\n  getWaste,\n  getTableau,\n  getFoundation,\n  getStock,\n  getScore\n} from '../redux/selectors'\nimport { undo, redo } from '../redux/undoable'\nimport { StockStore } from '../redux/stock'\nimport { ScoreStore } from '../redux/score'\nimport { ScoringType } from '../redux/globals'\n\ntype ContainerConnectedProps = {\n  tableau: Stack[]\n  foundation: Stack[]\n  stock: StockStore\n  waste: WasteStore\n  score: ScoreStore\n}\n\ntype ContainerActionProps = {\n  handleNewGame: () => void\n  handleSwitchGameType: (newScoringType: ScoringType) => void\n  handleStockClick: (stack: Stack, card?: StackCard) => void\n  handleTableauClick: (stack: Stack, card?: StackCard) => void\n  handleWasteClick: (stack: Stack, card?: StackCard) => void\n  handleFoundationClick: (stack: Stack, card?: StackCard) => void\n  handleDoubleClick: (stack: Stack, card?: StackCard) => void\n  handleUndo: () => void\n  handleRedo: () => void\n}\n\ntype ContainerProps = ContainerConnectedProps & ContainerActionProps\n\nclass ContainerComponent extends React.PureComponent<ContainerProps> {\n  constructor(props: ContainerProps) {\n    super(props)\n    this.handleNewGameClick = this.handleNewGameClick.bind(this)\n    this.handleStockClick = this.handleStockClick.bind(this)\n    this.handleTableauClick = this.handleTableauClick.bind(this)\n    this.handleWasteClick = this.handleWasteClick.bind(this)\n    this.handleFoundationClick = this.handleFoundationClick.bind(this)\n    this.handleDoubleClick = this.handleDoubleClick.bind(this)\n    this.handleKeyDown = this.handleKeyDown.bind(this)\n    this.handleSwitchGameTypeClick = this.handleSwitchGameTypeClick.bind(this)\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown)\n  }\n\n  handleNewGameClick() {\n    this.props.handleNewGame()\n  }\n\n  handleSwitchGameTypeClick() {\n    this.props.handleSwitchGameType(this.otherGameType)\n  }\n\n  handleKeyDown(e: KeyboardEvent) {\n    if (e.keyCode !== 90) {\n      return\n    }\n    if (e.ctrlKey && e.shiftKey) {\n      this.props.handleRedo()\n    } else if (e.ctrlKey) {\n      this.props.handleUndo()\n    }\n  }\n\n  handleStockClick(stack: Stack, card?: StackCard) {\n    this.props.handleStockClick(stack, card)\n  }\n\n  handleTableauClick(stack: Stack, card?: StackCard) {\n    this.props.handleTableauClick(stack, card)\n  }\n\n  handleWasteClick(stack: Stack, card?: StackCard) {\n    this.props.handleWasteClick(stack, card)\n  }\n\n  handleFoundationClick(stack: Stack, card?: StackCard) {\n    this.props.handleFoundationClick(stack, card)\n  }\n\n  handleDoubleClick(stack: Stack, card?: StackCard) {\n    this.props.handleDoubleClick(stack, card)\n  }\n\n  get otherGameType() {\n    return this.props.score.scoringType === ScoringType.vegas\n      ? ScoringType.regular\n      : ScoringType.vegas\n  }\n\n  render() {\n    return (\n      <div className={container}>\n        <FireworksComponent />\n        <div>\n          <button\n            id=\"new-game\"\n            className={newGame}\n            onClick={this.handleNewGameClick}\n          >\n            {'New Game'}\n          </button>\n          <button\n            id=\"change-type\"\n            className={switchScoreType}\n            onClick={this.handleSwitchGameTypeClick}\n          >\n            {' Switch to '}\n            {ScoringType[this.otherGameType]}\n          </button>\n          <label id=\"score\" className={score}>\n            {'Score: '}\n            {this.props.score.score}\n          </label>\n        </div>\n        <div className={top}>\n          <StackComponent\n            stack={this.props.stock.stacks[0]}\n            onClick={this.handleStockClick}\n            direction={StackDirection.none}\n            type={StackType.stock}\n            hidden={true}\n            max={1}\n            drawsLeft={this.props.stock.drawsLeft}\n          />\n          <StackComponent\n            stack={this.props.waste.stacks[0]}\n            onClick={this.handleWasteClick}\n            onDoubleClick={this.handleDoubleClick}\n            direction={StackDirection.horizontal}\n            type={StackType.waste}\n            hidden={false}\n            max={this.props.waste.showing}\n            offset={15}\n          />\n          {this.props.foundation.map((stack, index) => (\n            <StackComponent\n              key={`foundation-${index}`}\n              onClick={this.handleFoundationClick}\n              stack={stack}\n              direction={StackDirection.none}\n              type={StackType.foundation}\n              max={1}\n            />\n          ))}\n        </div>\n        <div className={play}>\n          {this.props.tableau.map((stack, index) => (\n            <StackComponent\n              key={`tableau-${index}`}\n              onClick={this.handleTableauClick}\n              onDoubleClick={this.handleDoubleClick}\n              stack={stack}\n              direction={StackDirection.vertical}\n              type={StackType.tableau}\n            />\n          ))}\n        </div>\n        <div className={version}>{process.env.version}</div>\n      </div>\n    )\n  }\n}\n\nconst selector = createSelector(\n  [getTableau, getFoundation, getStock, getWaste, getScore],\n  ({ stacks: tableau }, { stacks: foundation }, stock, waste, score) => ({\n    tableau,\n    foundation,\n    stock,\n    waste,\n    score\n  })\n)\n\nconst mapDispatchToProps = (dispatch: ThunkDispatch): ContainerActionProps => ({\n  handleNewGame: () => dispatch(initialize()),\n  handleSwitchGameType: newGameType => dispatch(initialize(newGameType)),\n  handleStockClick: () => dispatch(clickStock()),\n  handleTableauClick: (stack, card) => dispatch(clickTableau(stack, card)),\n  handleWasteClick: (stack, card) => dispatch(clickWaste(stack, card)),\n  handleFoundationClick: (stack, card) =>\n    dispatch(clickFoundation(stack, card)),\n  handleDoubleClick: (stack, card) => dispatch(doubleClick(stack, card)),\n  handleUndo: () => dispatch(undo()),\n  handleRedo: () => dispatch(redo())\n})\n\nconst mapStateToProps = (state: StoreState): ContainerConnectedProps =>\n  selector(state)\n\nexport const Container = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ContainerComponent)\n","import * as React from 'react'\nimport { stock, waste, tableau, foundation } from '../../styles/cards.scss'\nimport { Stack, StackCard, StackType, StackDirection } from '../lib/Stack'\n\ntype CardClickEvent = (stack: Stack, card: StackCard) => void\n\ntype StackOwnProps = {\n  type: StackType\n  direction: StackDirection\n  children?: React.ReactNode\n  stack: Stack\n  onClick?: CardClickEvent\n  onDoubleClick?: CardClickEvent\n  max: number\n  hidden: boolean\n  width: number\n  height: number\n  offset: number\n  radius: number\n  drawsLeft?: number\n}\n\ntype StackConnectedProps = {}\n\ntype StackProps = StackOwnProps & StackConnectedProps\n\ntype Point = {\n  x: number\n  y: number\n}\n\nexport class StackComponent extends React.PureComponent<StackProps> {\n  static defaultProps = {\n    max: Infinity,\n    hidden: false,\n    width: 74,\n    height: 97,\n    offset: 20,\n    radius: 10\n  }\n\n  private ref = React.createRef<HTMLCanvasElement>()\n\n  constructor(props: StackProps) {\n    super(props)\n    this.handleCanvasClick = this.handleCanvasClick.bind(this)\n    this.handleCanvasDoubleClick = this.handleCanvasDoubleClick.bind(this)\n  }\n\n  get stack_style(): string {\n    switch (this.props.type) {\n      case StackType.foundation:\n        return foundation\n      case StackType.tableau:\n        return tableau\n      case StackType.stock:\n        return stock\n      case StackType.waste:\n        return waste\n    }\n  }\n\n  get canvas_width() {\n    switch (this.props.direction) {\n      case StackDirection.none:\n      case StackDirection.vertical:\n        return this.props.width\n      case StackDirection.horizontal:\n        return this.cards.length === 0\n          ? this.props.height\n          : this.props.offset * (this.cards.length - 1) + this.props.width\n    }\n  }\n\n  get canvas_height() {\n    switch (this.props.direction) {\n      case StackDirection.none:\n      case StackDirection.horizontal:\n        return this.props.height\n      case StackDirection.vertical:\n        return this.cards.length === 0\n          ? this.props.height\n          : this.props.offset * (this.cards.length - 1) + this.props.height\n    }\n  }\n\n  get cards() {\n    return this.props.stack.cards.slice(-this.props.max)\n  }\n\n  handleCanvasDoubleClick(evt: React.MouseEvent<Element>) {\n    const { cards } = this\n    const { stack, offset, direction, onDoubleClick } = this.props\n    const { nativeEvent: e } = evt\n    if (!onDoubleClick) {\n      return\n    }\n\n    const prop = direction === StackDirection.horizontal ? 'offsetX' : 'offsetY'\n    const index = Math.min(cards.length - 1, Math.floor(e[prop] / offset))\n    onDoubleClick(stack, cards[index])\n  }\n\n  handleCanvasClick(evt: React.MouseEvent<Element>) {\n    const { cards } = this\n    const { stack, offset, direction, onClick } = this.props\n    const { nativeEvent: e } = evt\n    if (!onClick) {\n      return\n    }\n\n    const prop = direction === StackDirection.horizontal ? 'offsetX' : 'offsetY'\n    const index = Math.min(cards.length - 1, Math.floor(e[prop] / offset))\n    onClick(stack, cards[index])\n  }\n\n  componentDidMount() {\n    this.updateCanvas()\n  }\n\n  componentDidUpdate() {\n    this.updateCanvas()\n  }\n\n  updateCanvas() {\n    const canvas = this.ref.current\n    if (!canvas) {\n      return\n    }\n\n    const ctx = canvas.getContext('2d')\n    if (!ctx) {\n      return\n    }\n\n    const { cards } = this\n    const { direction, offset } = this.props\n\n    ctx.save()\n    ctx.translate(0.5, 0.5)\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n\n    if (cards.length === 0) {\n      this.drawBoxRadius(ctx, { x: 0, y: 0 })\n      ctx.stroke()\n\n      if (this.props.drawsLeft === 0) {\n        ctx.save()\n        ctx.font = '48px sans-serif'\n        ctx.fillStyle = 'red'\n        ctx.textAlign = 'center'\n        ctx.textBaseline = 'middle'\n        ctx.fillText('X', this.props.width / 2, this.props.height / 2)\n        ctx.restore()\n      }\n    }\n\n    for (let i = 0; i < cards.length; i++) {\n      const x = direction === StackDirection.horizontal ? i * offset : 0\n      const y = direction === StackDirection.horizontal ? 0 : i * offset\n\n      if (i < cards.length - 1) {\n        ctx.save()\n        this.drawClipRegion(ctx, { x, y })\n      }\n\n      this.drawCard(ctx, cards[i], { x, y })\n\n      if (i < cards.length - 1) {\n        ctx.restore()\n      }\n    }\n    ctx.restore()\n  }\n\n  drawClipRegion(ctx: CanvasRenderingContext2D, { x, y }: Point) {\n    const { direction, radius, offset, width, height } = this.props\n    const clip_width = direction === StackDirection.horizontal ? offset : width\n    const clip_height =\n      direction === StackDirection.horizontal ? height : offset\n\n    ctx.beginPath()\n    if (direction === StackDirection.horizontal) {\n      ctx.moveTo(x, y)\n      ctx.lineTo(x + clip_width + radius, y)\n      ctx.quadraticCurveTo(x + clip_width, y, x + clip_width, y + radius)\n      ctx.lineTo(x + clip_width, y + clip_height - radius)\n      ctx.quadraticCurveTo(\n        x + clip_width,\n        y + clip_height,\n        x + clip_width + radius,\n        y + clip_height\n      )\n      ctx.lineTo(x, y + clip_height)\n    } else {\n      ctx.moveTo(x + clip_width, y)\n      ctx.lineTo(x + clip_width, y + clip_height + radius)\n      ctx.quadraticCurveTo(\n        x + clip_width,\n        y + clip_height,\n        x + clip_width - radius,\n        y + clip_height\n      )\n      ctx.lineTo(x + radius, y + clip_height)\n      ctx.quadraticCurveTo(x, y + clip_height, x, y + clip_height + radius)\n      ctx.lineTo(x, y)\n    }\n    ctx.closePath()\n    ctx.clip()\n  }\n\n  drawBoxRadius(ctx: CanvasRenderingContext2D, { x, y }: Point) {\n    const { radius, height, width } = this.props\n    ctx.beginPath()\n    ctx.moveTo(x + radius, y)\n    ctx.lineTo(x + width - radius, y)\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius)\n    ctx.lineTo(x + width, y + height - radius)\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height)\n    ctx.lineTo(x + radius, y + height)\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius)\n    ctx.lineTo(x, y + radius)\n    ctx.quadraticCurveTo(x, y, x + radius, y)\n    ctx.closePath()\n  }\n\n  drawCard(\n    ctx: CanvasRenderingContext2D,\n    stack_card: StackCard,\n    { x, y }: Point\n  ) {\n    const { card, hidden, selected } = stack_card\n\n    this.drawBoxRadius(ctx, { x, y })\n    ctx.stroke()\n\n    if (hidden) {\n      ctx.fillStyle = '#0aa'\n      ctx.fill()\n      return\n    }\n\n    if (selected) {\n      ctx.fillStyle = 'yellow'\n      ctx.fill()\n    }\n\n    const { value, suit, drawing } = card\n\n    ctx.fillStyle = drawing.color\n    ctx.textAlign = 'center'\n    ctx.textBaseline = 'top'\n\n    ctx.font = drawing.cornerFont\n    ctx.fillText(value, drawing.valueXOffset + x, drawing.valueYOffset + y, 12)\n    ctx.fillText(suit, drawing.suitXOffset + x, drawing.suitYOffset + y)\n\n    ctx.save()\n    ctx.translate(this.props.width, this.props.height)\n    ctx.rotate(Math.PI)\n    ctx.fillText(value, drawing.valueXOffset - x, drawing.valueYOffset - y, 12)\n    ctx.fillText(suit, drawing.suitXOffset - x, drawing.suitYOffset - y)\n    ctx.restore()\n\n    ctx.textBaseline = 'middle'\n\n    for (const pos of drawing.positions) {\n      const factor = pos.rotated ? -1 : 1\n      ctx.textAlign = pos.textAlign\n\n      if (pos.rotated) {\n        ctx.save()\n        ctx.translate(this.props.width, this.props.height)\n        ctx.rotate(Math.PI)\n      }\n\n      ctx.font = `${drawing.fontSize} sans-serif`\n      ctx.fillText(suit, pos.left + x * factor, pos.top + y * factor)\n\n      if (pos.rotated) {\n        ctx.restore()\n      }\n    }\n  }\n\n  render() {\n    return (\n      <canvas\n        onDoubleClick={this.handleCanvasDoubleClick}\n        onClick={this.handleCanvasClick}\n        className={this.stack_style}\n        width={this.canvas_width + 1}\n        height={this.canvas_height + 1}\n        ref={this.ref}\n      />\n    )\n  }\n}\n","import * as React from 'react'\nimport { connect } from 'react-redux'\nimport { createSelector } from 'reselect'\nimport * as FireworksCanvas from 'fireworks-canvas'\n\nimport { fireworks } from '../../styles/cards.scss'\nimport { StoreState } from '../redux'\nimport { getFoundation } from '../redux/selectors'\n\ntype FireworksConnectedProps = {\n  active: boolean\n}\n\ntype FireworksProps = FireworksConnectedProps\n\nclass Fireworks extends React.PureComponent<FireworksProps> {\n  ref: React.RefObject<HTMLDivElement>\n  fireworks: FireworksCanvas\n\n  constructor(props: FireworksProps) {\n    super(props)\n    this.ref = React.createRef()\n    this.handleDocumentKeyDown = this.handleDocumentKeyDown.bind(this)\n  }\n\n  handleDocumentKeyDown(ev: KeyboardEvent) {\n    if (ev.keyCode === 27) {\n      this.fireworks.stop()\n    }\n  }\n\n  componentDidMount() {\n    if (!this.ref.current) {\n      return null\n    }\n    this.fireworks = new FireworksCanvas(this.ref.current)\n  }\n\n  componentDidUpdate() {\n    if (this.props.active) {\n      document.addEventListener('keydown', this.handleDocumentKeyDown)\n      this.fireworks.start()\n    } else {\n      document.removeEventListener('keydown', this.handleDocumentKeyDown)\n      this.fireworks.kill()\n    }\n  }\n\n  componentWillUnmount() {\n    this.fireworks.destroy()\n  }\n\n  render() {\n    return <div className={fireworks} ref={this.ref} />\n  }\n}\n\nconst selector = createSelector(\n  [getFoundation],\n  ({ stacks: foundation }) => ({\n    active: foundation.every(stack => stack.cards.length === 13)\n  })\n)\n\nconst mapStateToProps = (state: StoreState): FireworksConnectedProps =>\n  selector(state)\n\nexport default connect(mapStateToProps)(Fireworks)\n"],"sourceRoot":""}