(()=>{var e,t={3:e=>{e.exports={topBar:"XwVLUrO3NoD_AUivFS56j",fireworks:"_3nvOdthckw9G8z05Xiav92",game:"_1VoMUOf1IbpEJjbCNdZsU9",button:"OktEGbV1DqgG2_sQ16MRl",label:"_1HEad0y2SdUmqeXvzo2hG6",optionsMask:"_27aor1u7u5hz8M4_9poVe8",optionsModal:"_3gKGSm81FK9xUP7Tx5P_-n"}},730:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const r=a(294),o=a(940),n=a(409),c=a(938),i=a(5),s=a(638),l=a(626),d=a(956),u=()=>{const e=c.retrieve(c.PersistanceType.number,0),t=c.retrieve(c.PersistanceType.type,i.ScoringType.regular),a=c.retrieve(c.PersistanceType.theme,s.ColorSchemeType.dark);return l.default.dispatch(d.initializeGame({newType:t,newNumber:e,newTheme:a})),r.createElement(o.Provider,{store:l.default},r.createElement(n.default,null))};t.App=u,t.default=r.memo(u)},409:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(294),o=a(570),n=a(940),c=a(688),i=a(638),s=a(3),l=a(394),d=a(634),u=a(794),h=a(383),g=a(956),p=a(741),y=a(845);t.default=o.hot(r.memo((()=>{const e=n.useDispatch(),t=n.useSelector(y.getStacks),a=n.useSelector(y.getOverDrawn),o=n.useSelector(y.getShowing),m=n.useSelector(y.getTheme),f=n.useSelector(y.getScore),k=n.useSelector(y.getNumber),S=r.useMemo((()=>{const e=i.colorSchemes[m];return{"--background":e.background,"--color":e.color,"--emptyColor":e.emptyColor,"--faceUp":e.faceUp,"--hiddenColor1":e.hiddenColor1,"--hiddenColor2":e.hiddenColor2,"--buttonBorder":e.buttonBorder,"--cardBorder":e.cardBorder,"--black":e.black,"--red":e.red,"--selected":e.selected,"--errorColor":e.errorColor}}),[m]),[C,v]=r.useState(!1),T=r.useCallback((()=>v(!1)),[]),b=r.useCallback((()=>v(!0)),[]),w=r.useCallback((()=>e(g.newNumber())),[e]);return r.useEffect((()=>{const t=t=>{1===t.button&&(t.preventDefault(),e(g.performMoves()))},a=t=>{113===t.keyCode&&e(g.newNumber()),27===t.keyCode&&v((e=>!e)),90===t.keyCode&&(t.ctrlKey&&t.shiftKey?e(p.redo()):t.ctrlKey&&e(p.undo()))};return document.addEventListener("mousedown",t),document.addEventListener("keydown",a),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",a)}}),[e]),r.createElement("div",{style:S},r.createElement(l.default,null),C&&r.createElement(r.Fragment,null,r.createElement(h.default,{onClose:T,className:s.optionsModal}),r.createElement("div",{onClick:T,className:s.optionsMask})),r.createElement("div",{className:s.topBar},r.createElement("div",null,r.createElement("button",{tabIndex:1,onClick:w,className:s.button},"ðŸ”„ï¸Ž"),r.createElement("span",{className:s.label},k)),r.createElement("div",null,r.createElement("span",{className:s.label},f),r.createElement("button",{tabIndex:1,onClick:b,className:s.button},"â˜°ï¸Ž"))),r.createElement(d.default,{className:s.game},t.map((e=>r.createElement(u.default,Object.assign({key:`${e.type}-${e.index}`,stack:e},e.type===c.StackType.waste&&{showing:o},e.type===c.StackType.stock&&{overDrawn:a}))))))})))},394:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(294),o=a(940),n=a(382),c=a(845),i=a(3);t.default=r.memo((()=>{const e=r.useRef(null),t=r.useRef(),a=o.useSelector(c.getGameWon),s=a?"":"none";return r.useEffect((()=>{if(null==e.current)return;t.current=new n(e.current);return document.addEventListener("keydown",(e=>{var a;27===e.keyCode&&(null===(a=t.current)||void 0===a||a.stop())})),()=>{var e;null===(e=t.current)||void 0===e||e.destroy()}}),[e,a]),r.useEffect((()=>{var e,r;a?null===(e=t.current)||void 0===e||e.stop():null===(r=t.current)||void 0===r||r.start()}),[a]),r.createElement("div",{className:i.fireworks,style:{display:s},ref:e})}))},634:function(e,t,a){"use strict";var r=this&&this.__rest||function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(a[r[o]]=e[r[o]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.GameCanvas=t.GameCtx=void 0;const o=a(294),n=a(638),c=a(952),i=a(411),s=a(940),l=a(845);t.GameCtx=o.createContext(null);const d=(e,t)=>{const{nativeEvent:a}=e,r=a.target,o={x:a.offsetX,y:a.offsetY},n=r.getContext("2d");for(const e of t.keys())if(null==n?void 0:n.isPointInPath(e,o.x,o.y)){const a=t.get(e);if(null==a)return;return{thing:a,point:o}}},u=e=>{var{children:a}=e,u=r(e,["children"]);const h=o.useRef(new Map),g=o.useRef(new Map),p=o.useRef(new Map),{ctx:y,width:m,height:f,handleCanvasRef:k}=i.useCanvasSize(),S=s.useSelector(l.getTheme),C=n.colorSchemes[S],v=o.useMemo((()=>m&&f&&y?{ctx:y,width:m,height:f,colorSchemeType:S,colorScheme:C}:null),[y,m,f,S,C]);o.useLayoutEffect((()=>v&&c.initialize(v)||void 0),[v]);const T=o.useMemo((()=>v&&{context:v,add(e,t){h.current.set(e.path,e),t.onClick&&g.current.set(e.path,t.onClick),t.onDoubleClick&&p.current.set(e.path,t.onDoubleClick)},remove(e){h.current.delete(e),g.current.delete(e),p.current.delete(e)}}),[v]),b=o.useCallback((e=>{const t=d(e,h.current);if(t){const{thing:e,point:a}=t,r=p.current.get(e.path);r&&r(e,a)}}),[]),w=o.useCallback((e=>{const t=d(e,h.current);if(t){const{thing:e,point:a}=t,r=g.current.get(e.path);r&&r(e,a)}}),[]);return o.createElement(o.Fragment,null,o.createElement("canvas",Object.assign({id:"canvas",ref:k,width:window.innerWidth,height:window.innerHeight,onClick:w,onDoubleClick:b},u)),o.createElement(t.GameCtx.Provider,{value:T},a))};t.GameCanvas=u,t.default=o.memo(u)},383:function(e,t,a){"use strict";var r=this&&this.__rest||function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(a[r[o]]=e[r[o]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.Options=t.OptionCtx=void 0;const o=a(294),n=a(940),c=a(5),i=a(638),s=a(845),l=a(229),d=a(956),u=new Set;t.OptionCtx=o.createContext(u);const h=o.memo((e=>{var{value:t,onChange:a,name:n,options:c=[],label:i}=e,s=r(e,["value","onChange","name","options","label"]);const[l,d]=o.useState(t),h=o.useCallback((e=>d(e.target.value)),[]),g=o.useCallback((()=>{l!==t&&a(l)}),[t,l,a]);return o.useEffect((()=>(u.add(g),()=>{u.delete(g)}))),o.createElement("fieldset",Object.assign({},s),o.createElement("legend",null,i),0===c.length?o.createElement("div",null,o.createElement("label",{htmlFor:`option-${n}`,style:{display:"none"}},i),o.createElement("input",{type:"text",id:`option-${n}`,value:String(l),onChange:h})):c.map((([e,t])=>o.createElement("div",{key:e.toString()},o.createElement("input",{type:"radio",id:`${n}-${e}`,checked:l===t,value:String(t),onChange:h}),o.createElement("label",{htmlFor:`${n}-${e}`},e)))))}));h.displayName="Option";const g=[["Regular",c.ScoringType.regular],["Vegas",c.ScoringType.vegas]],p=[["Dark",i.ColorSchemeType.dark],["Light",i.ColorSchemeType.light]],y=o.memo((e=>{var{onClose:t}=e,a=r(e,["onClose"]);const c=o.useCallback((e=>{e.preventDefault(),u.forEach((e=>e())),t()}),[t]),i=n.useDispatch(),y=n.useSelector(s.getType),m=n.useSelector(s.getTheme),f=n.useSelector(s.getNumber),k=o.useCallback((e=>i(d.newNumber(parseInt(e,10)))),[i]),S=o.useCallback((e=>i(d.newType(e))),[i]),C=o.useCallback((e=>i(l.changeTheme(e))),[i]);return o.createElement("form",Object.assign({onSubmit:c},a),o.createElement(h,{name:"game-number",label:"Game Number",value:f,onChange:k}),o.createElement(h,{name:"type",label:"Game Type",value:y,onChange:S,options:g}),o.createElement(h,{name:"theme",label:"Theme",value:m,onChange:C,options:p}),o.createElement("button",{type:"submit"},"Save"))}));t.Options=y,y.displayName="OptionContainer",t.default=o.memo(y)},794:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StackElement=void 0;const r=a(294),o=a(634),n=a(669),c=a(688),i=a(940),s=a(956),l=a(126),d=a(294),u=({stack:e,overDrawn:t=!1,showing:a=1/0})=>{const u=i.useDispatch(),h=r.useContext(o.GameCtx),g=d.useMemo((()=>h&&n.getStackDrawingContext(h.context,e,{overDrawn:t,showing:a})),[h,e,t,a]),p=r.useCallback(((t,a)=>{if(null==h||null==g)return;const r=e.direction===c.StackDirection.horizontal?"x":"y",o=e.cards.slice(-g.max),n=Math.min(o.length-1,Math.floor((a[r]-g.box[r])/g.space));e.type===c.StackType.waste&&n!==o.length-1||u(s.doubleClickCard({stack:e,stackCard:o[n]}))}),[u,h,g,e]),y=r.useCallback(((t,a)=>{if(null==h||null==g)return;const r=e.direction===c.StackDirection.horizontal?"x":"y",o=e.cards.slice(-g.max),n=Math.min(o.length-1,Math.floor((a[r]-g.box[r])/g.space));e.type===c.StackType.waste&&n!==o.length-1||u(s.clickCard({stack:e,stackCard:o[n]}))}),[u,h,g,e]);return l.useDrawing((e=>n.drawStack(e,g)),{onClick:y,onDoubleClick:p}),null};t.StackElement=u,t.default=r.memo(u)},51:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorImageData=t.getCardImageData=t.getHiddenImageData=t.getEmptyImageData=t.getGlyphLocations=t.getBoxPath=void 0;const r=a(688),o=a(737),n=a(115),c=a(445);var i;t.getBoxPath=({x:e,y:t,width:a,height:r},o=10,n=0)=>{const c=new Path2D,i=e+n,s=t+n,l=a-2*n,d=r-2*n;return c.moveTo(i+o,s),c.lineTo(i+l-o,s),c.quadraticCurveTo(i+l,s,i+l,s+o),c.lineTo(i+l,s+d-o),c.quadraticCurveTo(i+l,s+d,i+l-o,s+d),c.lineTo(i+o,s+d),c.quadraticCurveTo(i,s+d,i,s+d-o),c.lineTo(i,s+o),c.quadraticCurveTo(i,s,i+o,s),c.closePath(),c},function(e){e[e.Regular=0]="Regular",e[e.Corner=1]="Corner"}(i||(i={}));t.getGlyphLocations=(e,{card:t,hidden:a})=>{if(a)return[];const{ctx:s}=e,{width:l,height:d}=c.getCardDimensions(e),u=c.getVerticalMarginSize(e),h=c.getHorizontalMarginSize(e),g=Math.floor(.2*l),p=e=>n.search(s,((a,r)=>e===i.Corner?a>g:o.isBig(t)?a>l-2*Math.floor(l/5):a>Math.floor(l/5)&&r>Math.floor(d/20)),e===i.Corner?"10":"â™¥"),y={[i.Corner]:p(i.Corner),[i.Regular]:p(i.Regular)},m=h/2,f=u/2,k=h/2,S=h/2+n.measureHeight(s,y[i.Corner]),{suit:C,value:v}=t,T=[{x:m,y:f,glyph:v},{x:k,y:S,glyph:C}].reduce(((e,t)=>(e.push(Object.assign(Object.assign({},t),{rotated:!1,textAlign:"left",textBaseline:"top",font:y[i.Corner]}),Object.assign(Object.assign({},t),{rotated:!0,textAlign:"left",textBaseline:"top",font:y[i.Corner]})),e)),[]),b=[];[r.ValueType.ace,r.ValueType.three,r.ValueType.five,r.ValueType.nine,r.ValueType.jack,r.ValueType.queen,r.ValueType.king].includes(v)&&b.push({x:1,y:3}),[r.ValueType.two,r.ValueType.three].includes(v)&&b.push({x:1,y:0},{x:1,y:6}),[r.ValueType.four,r.ValueType.five,r.ValueType.six,r.ValueType.seven,r.ValueType.eight,r.ValueType.nine,r.ValueType.ten].includes(v)&&b.push({x:0,y:0},{x:2,y:0},{x:0,y:6},{x:2,y:6}),[r.ValueType.six,r.ValueType.seven,r.ValueType.eight].includes(v)&&b.push({x:0,y:3},{x:2,y:3}),[r.ValueType.seven,r.ValueType.ten,r.ValueType.eight].includes(v)&&b.push({x:1,y:1}),[r.ValueType.nine,r.ValueType.ten].includes(v)&&b.push({x:0,y:2},{x:2,y:2},{x:0,y:4},{x:2,y:4}),[r.ValueType.ten,r.ValueType.eight].includes(v)&&b.push({x:1,y:5});const w=e=>{switch(e){case 0:case 6:return.2*d;case 1:case 5:return.3*d;case 2:case 4:return.4*d;case 3:return.5*d}},x=e=>{switch(e){case 0:return.25*l;case 1:return.5*l;case 2:return.75*l}},O=e=>{switch(e){case 0:return"left";case 1:return"center";case 2:return"right"}};return b.forEach((({x:e,y:t})=>{T.push({x:x(e),y:w(t),glyph:C,textAlign:O(e),textBaseline:"middle",rotated:t>3,font:y[i.Regular]})})),T};t.getEmptyImageData=e=>{const{ctx:t,colorScheme:a}=e,{width:r,height:o}=c.getCardDimensions(e),n={x:0,y:0,width:r,height:o};return t.clearRect(0,0,r,o),t.fillStyle=a.emptyColor,t.fillRect(n.x,n.y,n.width,n.height),t.lineWidth=.5,t.strokeStyle=a.cardBorder,t.strokeRect(n.x,n.y,n.width,n.height),t.getImageData(n.x,n.y,n.width,n.height)};t.getHiddenImageData=e=>{const{ctx:a,colorScheme:r}=e,{width:o,height:n}=c.getCardDimensions(e),i={x:0,y:0,width:o,height:n},s=document.createElement("canvas");s.width=s.height=25;const l=s.getContext("2d"),d=l.createLinearGradient(0,0,s.width,s.height);return d.addColorStop(0,r.hiddenColor1),d.addColorStop(.25,r.hiddenColor1),d.addColorStop(.25,r.hiddenColor2),d.addColorStop(.5,r.hiddenColor2),d.addColorStop(.5,r.hiddenColor1),d.addColorStop(.75,r.hiddenColor1),d.addColorStop(.75,r.hiddenColor2),d.addColorStop(1,r.hiddenColor2),l.fillStyle=d,l.fillRect(0,0,25,25),a.clearRect(i.x,i.y,i.width,i.height),a.strokeStyle=r.cardBorder,a.lineWidth=3,a.stroke(t.getBoxPath(i)),a.save(),a.clip(t.getBoxPath(i,10)),a.fillStyle=a.createPattern(s,"repeat"),a.fillRect(i.x+1,i.y+1,i.width-2,i.height-2),a.restore(),a.getImageData(i.x,i.y,i.width,i.height)};t.getCardImageData=(e,a)=>{const{ctx:r,colorScheme:n}=e,{width:i,height:s}=c.getCardDimensions(e),l={x:0,y:0,width:i,height:s};r.clearRect(l.x,l.y,l.width,l.height),r.strokeStyle=n.cardBorder,r.lineWidth=2,r.stroke(t.getBoxPath(l,10)),r.fillStyle=a.selected?n.selected:n.faceUp,r.fill(t.getBoxPath(l,10,.5));for(const c of t.getGlyphLocations(e,a))r.fillStyle=o.isRed(a.card)?n.red:n.black,r.textAlign=c.textAlign,r.textBaseline=c.textBaseline,r.font=c.font,c.rotated&&(r.save(),r.translate(i,s),r.rotate(Math.PI)),r.fillText(c.glyph,c.x+l.x*(c.rotated?-1:1),c.y+l.y*(c.rotated?-1:1)),c.rotated&&r.restore();return r.getImageData(l.x,l.y,l.width,l.height)};t.getErrorImageData=e=>{const{ctx:a,colorScheme:r}=e,{width:o,height:n}=c.getCardDimensions(e),i={x:0,y:0,width:o,height:n};return a.clearRect(i.x,i.y,i.width,i.height),a.fillStyle=r.emptyColor,a.fill(t.getBoxPath(i)),a.font="48px sans-serif",a.textAlign="center",a.textBaseline="middle",a.fillStyle=r.errorColor,a.fillText("X",i.width/2,i.height/2),a.getImageData(i.x,i.y,i.width,i.height)}},638:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.colorSchemes=t.ColorSchemeType=void 0,function(e){e.dark="dark",e.light="light"}(a=t.ColorSchemeType||(t.ColorSchemeType={})),t.colorSchemes={[a.dark]:{background:"#000",color:"#fff",emptyColor:"#060606",faceUp:"#ddd",hiddenColor1:"#404dac",hiddenColor2:"#263278",buttonBorder:"#ddd",cardBorder:"#000",black:"#505050",red:"#f03a17",selected:"#fff000",errorColor:"#900"},[a.light]:{background:"#ffffff",color:"#000",emptyColor:"#f5f5f5",faceUp:"#ddd",hiddenColor1:"#606dbc",hiddenColor2:"#465298",buttonBorder:"#000",cardBorder:"#000",black:"#505050",red:"#f03a17",selected:"#fff000",errorColor:"red"}}},952:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeDataToCanvas=t.initialize=t.cardCache=t.getKey=void 0;const r=a(688),o=a(51),n=a(445);let c;t.getKey=({card:{suit:e,value:t},selected:a})=>`${e}_${t}_${(a||!1).toString()}`,t.cardCache=new Map;t.initialize=e=>{const{width:a,height:i}=n.getCardDimensions(e);t.cardCache.set("hidden",o.getHiddenImageData(e)),t.cardCache.set("empty",o.getEmptyImageData(e)),t.cardCache.set("error",o.getErrorImageData(e)),r.Cards.forEach((a=>{t.cardCache.set(t.getKey({card:a,selected:!0}),o.getCardImageData(e,{card:a,selected:!0})).set(t.getKey({card:a,selected:!1}),o.getCardImageData(e,{card:a,selected:!1}))})),c=document.createElement("canvas"),c.width=a,c.height=i,e.ctx.clearRect(0,0,a+2,i+2)};t.writeDataToCanvas=(e,t,a,r)=>{const o=c.getContext("2d");null==o||o.putImageData(t,0,0),e.ctx.drawImage(c,a,r)}},115:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.search=t.measureHeight=t.measureWidth=void 0;const a=Array.from({length:200},((e,t)=>t));t.measureWidth=(e,t,a)=>(e.font=t,e.measureText(a).width);t.measureHeight=(e,t)=>(e.font=t,e.measureText("M").width);const r=(e,o,n,c,i)=>{const s=Math.floor((i+c)/2),l=`${a[s]}px sans-serif`,d=t.measureWidth(e,l,n),u=t.measureHeight(e,l);return c>i?l:o(d,u)?r(e,o,n,c,s-1):r(e,o,n,s+1,i)};t.search=(e,t,o)=>r(e,t,o,0,a.length-1)},445:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStackBox=t.getCardDimensions=t.getTopbarBox=t.getHorizontalMarginSize=t.getVerticalMarginSize=t.getStackCardOffsetHeight=t.getStackCardOffsetWidth=void 0;const r=a(688);t.getStackCardOffsetWidth=e=>Math.floor(.03*e.height);t.getStackCardOffsetHeight=e=>Math.floor(.03*e.height);t.getVerticalMarginSize=e=>Math.floor(.01*e.height);t.getHorizontalMarginSize=e=>Math.floor(.01*e.width);t.getTopbarBox=()=>({x:0,y:0,width:0,height:30});t.getCardDimensions=e=>{const a=t.getHorizontalMarginSize(e),r=t.getVerticalMarginSize(e),o=t.getTopbarBox(),n=t.getStackCardOffsetHeight(e),c=o.height+2*r+19*n,i=6*a,s=Math.floor((e.width-i)/7),l=Math.floor((e.height-c)/1.5),d=1.618,u=s*d<l?s:l/d,h=s*d<l?s*d:l;return{width:Math.floor(u),height:Math.floor(h)}};t.getStackBox=(e,a,o)=>{const n=t.getVerticalMarginSize(e),c=t.getHorizontalMarginSize(e),i=t.getTopbarBox(),{width:s,height:l}=t.getCardDimensions(e),d=Math.min(a.cards.length,o),u=6*c+7*s,h=u<e.width?(e.width-u)/2:0,g=a.direction===r.StackDirection.horizontal?0===d?l:t.getStackCardOffsetWidth(e)*(d-1)+s:s,p=a.direction===r.StackDirection.vertical?0===d?l:t.getStackCardOffsetHeight(e)*(d-1)+l:l;switch(a.type){case r.StackType.stock:return{y:i.height+n,x:h,width:g,height:p};case r.StackType.waste:return{y:i.height+n,x:h+c+s,width:g,height:p};case r.StackType.foundation:return{y:i.height+n,x:h+3*c+3*s+a.index*(c+s),width:g,height:p};case r.StackType.tableau:return{y:i.height+3*n+l,x:h+a.index*(c+s),width:g,height:p}}}},669:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStack=t.getStackDrawingContext=void 0;const r=a(688),o=a(952),n=a(445);t.getStackDrawingContext=(e,t,a)=>{const o=t.type===r.StackType.stock||t.type===r.StackType.foundation?1:t.type===r.StackType.waste?a.showing||0:t.cards.length,c=n.getStackBox(e,t,o),i=t.direction===r.StackDirection.horizontal?n.getStackCardOffsetWidth(e):n.getStackCardOffsetHeight(e);return{stack:t,overDrawn:a.overDrawn,showing:a.showing,space:i,box:c,max:o}};t.drawStack=(e,t)=>{if(null==t)return null;const{stack:a,overDrawn:n,max:c,space:i,box:s}=t,l=a.cards.slice(-c),d=new Path2D;d.rect(s.x,s.y,s.width,s.height),d.closePath();const u=0===l.length,h=a.type===r.StackType.stock&&u&&n,g=[];h?g.push({data:o.cardCache.get("error"),x:s.x,y:s.y}):u?g.push({data:o.cardCache.get("empty"),x:s.x,y:s.y}):l.forEach(((e,t)=>{const n=e.hidden?o.cardCache.get("hidden"):o.cardCache.get(o.getKey(e));if(n){const e=a.direction===r.StackDirection.horizontal?t*i:0,o=a.direction===r.StackDirection.horizontal?0:t*i;g.push({data:n,x:s.x+e,y:s.y+o})}}));for(const{data:t,x:a,y:r}of g)t&&o.writeDataToCanvas(e,t,a,r);return{path:d,box:s}}},411:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useCanvasSize=void 0;const r=a(294);t.useCanvasSize=()=>{const[e,t]=r.useState(null),a=r.useCallback((e=>e&&t(e)),[]),o=()=>({width:window.innerWidth,height:window.innerHeight}),[n,c]=r.useState();r.useEffect((()=>{let e;const t=()=>{e&&clearTimeout(e),e=window.setTimeout((()=>c(o())),300)};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}));return r.useMemo((()=>Object.assign({handleCanvasRef:a},e&&Object.assign({ctx:e.getContext("2d")},null!=n?n:o()))),[n,a,e])}},126:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDrawing=void 0;const r=a(294),o=a(634);t.useDrawing=(e,t={})=>{var a,n;const c=r.useContext(o.GameCtx),i=r.useRef(!0),s=r.useRef(null!==(a=null==c?void 0:c.context.width)&&void 0!==a?a:0),l=r.useRef(null!==(n=null==c?void 0:c.context.height)&&void 0!==n?n:0);r.useLayoutEffect((()=>{c&&(i.current=!((l.current!==c.context.height||s.current!==c.context.width)&&l.current>0&&s.current>0),l.current=c.context.height,s.current=c.context.width)}),[c]),r.useEffect((()=>{if(null==c)return;const{add:a,remove:r,context:o}=c,{ctx:n}=o,s=e(o);return null!=s?(a(s,t),()=>{r(s.path),i.current&&n.clearRect(s.box.x,s.box.y,s.box.width,s.box.height),i.current=!0}):void 0}))}},70:(e,t,a)=>{"use strict";const r=a(294),o=a(935),n=a(731),c=a(730);n.install({onUpdateReady(){n.applyUpdate()},onUpdated(){window.location.reload()}}),o.render(r.createElement(c.default,null),document.getElementById("root"))},688:(e,t)=>{"use strict";var a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Cards=t.StackType=t.StackDirection=t.SuitType=t.ValueType=void 0,function(e){e.ace="A",e.two="2",e.three="3",e.four="4",e.five="5",e.six="6",e.seven="7",e.eight="8",e.nine="9",e.ten="10",e.jack="J",e.queen="Q",e.king="K"}(a=t.ValueType||(t.ValueType={})),function(e){e.heart="â™¥",e.diamond="â™¦",e.spade="â™ ",e.club="â™£"}(r=t.SuitType||(t.SuitType={})),function(e){e.horizontal="horizontal",e.vertical="vertical"}(t.StackDirection||(t.StackDirection={})),function(e){e.tableau="tableau",e.foundation="foundation",e.stock="stock",e.waste="waste"}(t.StackType||(t.StackType={}));const o=[];t.Cards=o;for(const e of Object.values(a))for(const t of Object.values(r))o.push({suit:t,value:e});Object.freeze(o)},938:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieve=t.persist=t.PersistanceType=void 0,function(e){e.type="game-mode",e.theme="theme",e.score="score",e.number="game-number"}(t.PersistanceType||(t.PersistanceType={}));t.persist=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){}};t.retrieve=(e,t)=>{try{const t=localStorage.getItem(e)||"";return JSON.parse(t)}catch(e){return t}}},5:(e,t)=>{"use strict";var a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getScoreChange=t.ScoreType=t.ScoringType=void 0,function(e){e.vegas="vegas",e.regular="regular"}(a=t.ScoringType||(t.ScoringType={})),function(e){e.wasteToTableau="wasteToTableau",e.wasteToFoundation="wasteToFoundation",e.tableauToFoundation="tableauToFoundation",e.revealCard="revealCard",e.foundationToTableau="foundationToTableau"}(r=t.ScoreType||(t.ScoreType={}));t.getScoreChange=(e,t)=>{let o=0;return e===a.regular&&t===r.tableauToFoundation?o=10:t===r.wasteToFoundation||e===a.vegas&&t===r.tableauToFoundation||e===a.regular&&t===r.revealCard||e===a.regular&&t===r.wasteToTableau?o=5:e===a.regular&&r.foundationToTableau?o=-10:e===a.vegas&&t===r.foundationToTableau&&(o=-5),o}},737:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidTableauMove=t.isValidFoundationMove=t.isBig=t.isBlack=t.isRed=t.isSequential=t.stackContainsCard=t.sameCard=t.sameStack=t.random=t.getTopCard=t.sumConsecutive=t.rnd=void 0;const r=a(688);t.rnd=e=>{const t=()=>(Math.pow(2,31)-1&(e=Math.imul(48271,e)))/Math.pow(2,31);return t(),(e,a)=>Math.floor(t()*a)+e};t.sumConsecutive=e=>e*(e+1)/2;t.getTopCard=e=>e.cards[e.cards.length-1]||null;t.random=(e,t)=>Math.floor(Math.random()*t)+e;t.sameStack=(e,t)=>e.type===t.type&&e.index===t.index;t.sameCard=(e,t)=>e.card.value===t.card.value&&e.card.suit===t.card.suit;t.stackContainsCard=(e,a)=>e.some((e=>t.sameCard(e,a)));t.isSequential=(e,t)=>o(t.value)+1===o(e.value);t.isRed=e=>[r.SuitType.diamond,r.SuitType.heart].includes(e.suit);t.isBlack=e=>[r.SuitType.club,r.SuitType.spade].includes(e.suit);t.isBig=e=>[r.ValueType.ace,r.ValueType.jack,r.ValueType.queen,r.ValueType.king].includes(e.value);t.isValidFoundationMove=(e,a)=>null==a?e.card.value===r.ValueType.ace:a.card.suit===e.card.suit&&t.isSequential(e.card,a.card);t.isValidTableauMove=(e,a)=>null==a?e.card.value===r.ValueType.king:t.isSequential(a.card,e.card)&&(t.isRed(e.card)&&t.isBlack(a.card)||t.isBlack(e.card)&&t.isRed(a.card));const o=e=>e===r.ValueType.ace?1:e===r.ValueType.jack?11:e===r.ValueType.queen?12:e===r.ValueType.king?13:parseInt(e,10)},229:(e,t,a)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.changeTheme=t.incrementScore=t.incrementDraws=void 0;const o=a(770),n=a(688),c=a(938),i=a(5),s=a(638),l=a(130),d=a(741),u=a(777),h=o.createSlice({name:"game-state",initialState:{draws:0,number:0,score:0,scoringType:i.ScoringType.regular,showing:0,theme:s.ColorSchemeType.dark},reducers:{incrementDraws(e){e.draws=e.draws+1},incrementScore(e,{payload:t}){e.score=e.score+i.getScoreChange(e.scoringType,t)},changeTheme(e,{payload:t}){e.theme=t}},extraReducers:e=>e.addCase(l.initialize,((e,{payload:t})=>{e.draws=0,e.number=t.number,e.score=t.scoringType===i.ScoringType.vegas?c.retrieve(c.PersistanceType.score,0)-52:0,e.scoringType=t.scoringType,e.showing=3,e.theme=t.theme})).addMatcher((e=>u.shiftCards.match(e)&&(e.payload.to.type===n.StackType.waste||e.payload.from&&e.payload.from.type===n.StackType.waste)),((e,{payload:{to:t,cards:a}})=>{e.showing=t.type===n.StackType.waste?Math.min(t.cards.length+a.length,3):Math.max(1,e.showing-1)}))});r=h.actions,t.incrementDraws=r.incrementDraws,t.incrementScore=r.incrementScore,t.changeTheme=r.changeTheme,t.default=d.undoable(h.reducer)},626:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(770),o=(a(500),a(595)),n=a(845),c=a(777),i=a(229),s=a(938),l=a(5),d=r.getDefaultMiddleware({immutableCheck:!1,serializableCheck:!1});const u=r.combineReducers({stacks:c.default,gameState:i.default}),h=r.configureStore({reducer:u,middleware:d});o.default(h,n.getGameState,(({scoringType:e,score:t})=>{e===l.ScoringType.vegas&&s.persist(s.PersistanceType.score,t)})),o.default(h,n.getType,(e=>s.persist(s.PersistanceType.type,e))),o.default(h,n.getTheme,(e=>s.persist(s.PersistanceType.theme,e))),o.default(h,n.getNumber,(e=>s.persist(s.PersistanceType.number,e))),t.default=h},130:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=void 0;const r=a(770);t.initialize=r.createAction("initialize")},845:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disallowClickStock=t.getSelection=t.getNumber=t.getShowing=t.getOverDrawn=t.getDraws=t.getType=t.getScore=t.getTheme=t.getGameState=t.getFoundationStack=t.getWaste=t.getStock=t.getMovableToFoundation=t.getHiddenCard=t.getGameWon=t.getTableau=t.getStacks=void 0;const r=a(222),o=a(688),n=a(737),c=a(5);t.getStacks=r.createSelector((e=>e.stacks.present.stacks),(e=>e));const i=r.createSelector(t.getStacks,(e=>e.filter((e=>e.type===o.StackType.foundation))));t.getTableau=r.createSelector(t.getStacks,(e=>e.filter((e=>e.type===o.StackType.tableau)))),t.getGameWon=r.createSelector(i,(e=>e.every((e=>13===e.cards.length)))),t.getHiddenCard=r.createSelector(t.getTableau,(e=>e.reduce(((e,t)=>{if(e)return e;const a=n.getTopCard(t);return a&&a.hidden?{stack:t,stackCard:a}:null}),null))),t.getMovableToFoundation=r.createSelector([t.getStacks,i],((e,t)=>e.filter((e=>e.type!==o.StackType.foundation)).reduce(((e,a)=>{if(e)return e;const r=n.getTopCard(a);return null==r||r.hidden?e:t.some((e=>n.isValidFoundationMove(r,n.getTopCard(e))))?{stack:a,stackCard:r}:null}),null))),t.getStock=r.createSelector(t.getStacks,(e=>e.filter((e=>e.type===o.StackType.stock))[0])),t.getWaste=r.createSelector(t.getStacks,(e=>e.filter((e=>e.type===o.StackType.waste))[0])),t.getFoundationStack=r.createSelector(i,((e,t)=>t),((e,t)=>e.find((e=>n.isValidFoundationMove(t,n.getTopCard(e)))))),t.getGameState=r.createSelector((e=>e.gameState.present),(e=>e)),t.getTheme=r.createSelector(t.getGameState,(e=>e.theme)),t.getScore=r.createSelector(t.getGameState,(e=>e.score)),t.getType=r.createSelector(t.getGameState,(e=>e.scoringType)),t.getDraws=r.createSelector(t.getGameState,(e=>e.draws));t.getOverDrawn=r.createSelector([t.getDraws,t.getType],((e,t)=>t===c.ScoringType.vegas&&e+1>3)),t.getShowing=r.createSelector(t.getGameState,(({showing:e})=>e)),t.getNumber=r.createSelector(t.getGameState,(({number:e})=>e)),t.getSelection=r.createSelector(t.getStacks,(e=>{const t=e.find((e=>null!=e.selection));return t?{stackCard:t.selection,stack:t}:null})),t.disallowClickStock=r.createSelector([t.getStock,t.getOverDrawn],((e,t)=>0===e.cards.length&&t))},777:(e,t,a)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.recycleWaste=t.drawStockCards=t.moveCards=t.shiftCards=t.revealTop=t.deselectCard=t.selectCard=void 0;const o=a(770),n=a(688),c=a(737),i=a(741),s=a(130),l=o.createSlice({name:"stacks",initialState:{stacks:[{type:n.StackType.stock,direction:null,cards:[],index:0,selection:null},{type:n.StackType.waste,direction:n.StackDirection.horizontal,cards:[],index:0,selection:null},...Array.from({length:7},((e,t)=>({type:n.StackType.tableau,direction:n.StackDirection.vertical,cards:[],index:t,selection:null}))),...Array.from({length:4},((e,t)=>({type:n.StackType.foundation,direction:null,cards:[],index:t,selection:null})))]},reducers:{shiftCards:(e,{payload:{from:t,to:a,cards:r,hidden:o}})=>{const n=e.stacks.find((e=>c.sameStack(a,e))),i=e.stacks.find((e=>c.sameStack(t,e)));n&&n.cards.push(...r.map((e=>Object.assign(Object.assign({},e),{selected:!1,hidden:o})))),i&&(i.cards=i.cards.filter((e=>!c.stackContainsCard(r,e))))},revealTop:(e,{payload:t})=>{const a=e.stacks.find((e=>c.sameStack(e,t)));if(a){const e=a.cards[a.cards.length-1];e&&(e.hidden=!1)}},selectCard:(e,{payload:t})=>{const a=e.stacks.find((e=>c.sameStack(e,t.stack)));if(a){a.selection=t.stackCard;const e=a.cards.find((e=>c.sameCard(e,t.stackCard)));e&&(e.selected=!0)}},deselectCard:e=>{const t=e.stacks.find((e=>null!=e.selection));if(t){t.selection=null;const e=t.cards.find((e=>e.selected));e&&(e.selected=!1)}}},extraReducers:e=>e.addCase(s.initialize,((e,{payload:t})=>{e.stacks=e.stacks.map((e=>{switch(e.type){case n.StackType.foundation:case n.StackType.waste:return Object.assign(Object.assign({},e),{cards:[]});case n.StackType.stock:return Object.assign(Object.assign({},e),{cards:t.cards.slice(0,24).map((e=>({card:e,hidden:!0})))});case n.StackType.tableau:return Object.assign(Object.assign({},e),{cards:t.cards.slice(24+c.sumConsecutive(e.index),24+c.sumConsecutive(e.index)+e.index+1).map(((e,t,a)=>({card:e,hidden:a.length!==t+1})))})}}))}))});r=l.actions,t.selectCard=r.selectCard,t.deselectCard=r.deselectCard,t.revealTop=r.revealTop,t.shiftCards=r.shiftCards;t.moveCards=(e,a,r)=>t.shiftCards({from:e,to:a,cards:e.cards.slice(e.cards.findIndex((e=>r&&c.sameCard(e,r)))),hidden:!1});t.drawStockCards=({stock:e,waste:a})=>t.shiftCards({from:e,to:a,cards:e.cards.slice(-3).reverse(),hidden:!1});t.recycleWaste=({stock:e,waste:a})=>t.shiftCards({from:a,to:e,cards:a.cards.slice(0).reverse(),hidden:!0}),t.default=i.undoable(l.reducer)},956:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doubleClickCard=t.clickCard=t.performMoves=t.initializeGame=t.newNumber=t.newType=void 0;const r=a(737),o=a(688),n=a(5),c=a(130),i=a(777),s=a(845),l=a(741),d=a(229);t.newType=e=>t.initializeGame({newNumber:Math.floor(1e3*Math.random()),newType:e});t.newNumber=e=>t.initializeGame({newNumber:null==e?Math.floor(1e3*Math.random()):e});t.initializeGame=({newType:e,newNumber:t,newTheme:a})=>(n,i)=>{const l=null==t?s.getNumber(i()):t,d=null==e?s.getType(i()):e,u=null==a?s.getTheme(i()):a,h=Array.from(o.Cards),g=[],p=r.rnd(l);for(let e=0;e<52;e+=1){const e=p(0,h.length),[t]=h.splice(e,1);g.push(t)}n(c.initialize({scoringType:d,cards:g,number:l,theme:u}))};t.performMoves=()=>(e,t)=>{var a,r;let o;for(;o=s.getMovableToFoundation(t())||s.getHiddenCard(t());)null!==(r=null===(a=o.stackCard)||void 0===a?void 0:a.hidden)&&void 0!==r&&r?e(u(o)):e(h(o))};const u=e=>t=>{null!=e&&(t(l.checkpoint()),t(d.incrementScore(n.ScoreType.revealCard)),t(i.revealTop(e.stack)))},h=e=>(t,a)=>{const r=e.stackCard&&s.getFoundationStack(a(),e.stackCard);r&&e.stackCard&&(t(i.deselectCard()),t(l.checkpoint()),e.stack.type===o.StackType.waste&&t(d.incrementScore(n.ScoreType.wasteToFoundation)),e.stack.type===o.StackType.tableau&&t(d.incrementScore(n.ScoreType.tableauToFoundation)),t(i.moveCards(e.stack,r,e.stackCard)))};t.clickCard=e=>(t,a)=>{const{stackCard:c,stack:u}=e;if(null!=c&&c.selected)return t(i.deselectCard());const g=s.getSelection(a());if(null==g&&c&&!c.hidden)return t(i.selectCard({stack:u,stackCard:c}));if(u.type===o.StackType.foundation&&g)t(h(g));else if(u.type===o.StackType.tableau&&(null==g&&c&&c.hidden&&(t(l.checkpoint()),t(d.incrementScore(n.ScoreType.revealCard)),t(i.revealTop(u))),g&&g.stackCard&&r.isValidTableauMove(g.stackCard,c)&&(t(i.deselectCard()),t(l.checkpoint()),g.stack.type===o.StackType.waste&&t(d.incrementScore(n.ScoreType.wasteToTableau)),g.stack.type===o.StackType.foundation&&t(d.incrementScore(n.ScoreType.foundationToTableau)),t(i.moveCards(g.stack,u,g.stackCard)))),u.type===o.StackType.stock){if(s.disallowClickStock(a()))return;g&&t(i.deselectCard());const e=s.getWaste(a()),r=s.getStock(a());t(l.checkpoint()),r.cards.length>0?t(i.drawStockCards({stock:r,waste:e})):(t(i.recycleWaste({stock:r,waste:e})),t(d.incrementDraws()))}};t.doubleClickCard=e=>t=>{const{stack:a,stackCard:r}=e;a.type!==o.StackType.foundation&&a.type!==o.StackType.stock&&null!=r&&null!=r.card&&t(h({stack:a,stackCard:r}))}},741:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.undoable=t.checkpoint=t.redo=t.undo=t.destroy=void 0;const r=a(770);t.destroy=r.createAction("destroy"),t.undo=r.createAction("undo"),t.redo=r.createAction("redo"),t.checkpoint=r.createAction("checkpoint");t.undoable=e=>{const a={past:[],present:e(void 0,{}),future:[]};return(r=a,o)=>{const{past:n,present:c,future:i}=r;if(t.undo.match(o)){const e=n[n.length-1];if(!e)return r;return{past:n.slice(0,n.length-1),present:e,future:[c,...i]}}if(t.redo.match(o)){const e=i[0];if(!e)return r;const t=i.slice(1);return{past:[...n,c],present:e,future:t}}const s=e(c,o);return t.destroy.match(o)?{past:[],present:s,future:[]}:t.checkpoint.match(o)?{past:[...n,c],present:s,future:[]}:c===s?r:{past:n,present:s,future:i}}}}},a={};function r(e){var o=a[e];if(void 0!==o)return o.exports;var n=a[e]={exports:{}};return t[e].call(n.exports,n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,a,o,n)=>{if(!a){var c=1/0;for(l=0;l<e.length;l++){for(var[a,o,n]=e[l],i=!0,s=0;s<a.length;s++)(!1&n||c>=n)&&Object.keys(r.O).every((e=>r.O[e](a[s])))?a.splice(s--,1):(i=!1,n<c&&(c=n));i&&(e.splice(l--,1),t=o())}return t}n=n||0;for(var l=e.length;l>0&&e[l-1][2]>n;l--)e[l]=e[l-1];e[l]=[a,o,n]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={604:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var o,n,[c,i,s]=a,l=0;for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(s)var d=s(r);for(t&&t(a);l<c.length;l++)n=c[l],r.o(e,n)&&e[n]&&e[n][0](),e[c[l]]=0;return r.O(d)},a=self.webpackChunkklondike=self.webpackChunkklondike||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=r.O(void 0,[720],(()=>r(70)));o=r.O(o)})();
//# sourceMappingURL=klondike.80b6f199d176e83fd659.js.map